<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta name="generator" content="HTML Tidy for Cygwin (vers 1st September 2004), see www.w3.org" />
<title>Shell configuration files</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Org-mode" />
<meta name="author" content="Fabrice Niessen" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/htmlize.css" />
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/bigblow.css" />
<link rel="stylesheet" type="text/css" href="http://www.pirilampo.org/styles/bigblow/css/hideshow.css" />
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-1.11.0.min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery-ui-1.10.2.min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.localscroll-min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.scrollTo-1.4.3.1-min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/jquery.zclip.min.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/bigblow.js">
</script>
<script type="text/javascript" src="http://www.pirilampo.org/styles/bigblow/js/hideshow.js">
</script>
</head>
<body>
<div id="content">
<h1 class="title">Shell configuration files</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgheadline1">1. Documentation</a></li>
<li><a href="#orgheadline4">2. Startup files</a>
<ul>
<li><a href="#orgheadline2">2.1. What to put where?</a></li>
<li><a href="#orgheadline3">2.2. Note</a></li>
</ul>
</li>
<li><a href="#orgheadline5">3. Terminals</a></li>
<li><a href="#orgheadline19">4. Bash specific</a>
<ul>
<li><a href="#orgheadline6">4.1. Profile</a></li>
<li><a href="#orgheadline7">4.2. Preamble</a></li>
<li><a href="#orgheadline13">4.3. Variables</a>
<ul>
<li><a href="#orgheadline8">4.3.1. Search path</a></li>
<li><a href="#orgheadline9">4.3.2. Prompt</a></li>
<li><a href="#orgheadline10">4.3.3. Command history</a></li>
<li><a href="#orgheadline11">4.3.4. Term</a></li>
<li><a href="#orgheadline12">4.3.5. Display</a></li>
</ul>
</li>
<li><a href="#orgheadline14">4.4. Code</a></li>
<li><a href="#orgheadline15">4.5. Next</a></li>
<li><a href="#orgheadline16">4.6. Source common files</a></li>
<li><a href="#orgheadline17">4.7. Next</a></li>
<li><a href="#orgheadline18">4.8. Postamble</a></li>
</ul>
</li>
<li><a href="#orgheadline37">5. Zsh specific</a>
<ul>
<li><a href="#orgheadline20">5.1. Examples</a></li>
<li><a href="#orgheadline21">5.2. Preamble</a></li>
<li><a href="#orgheadline27">5.3. Variables</a>
<ul>
<li><a href="#orgheadline22">5.3.1. Search path</a></li>
<li><a href="#orgheadline23">5.3.2. Prompt</a></li>
<li><a href="#orgheadline24">5.3.3. Command history</a></li>
<li><a href="#orgheadline25">5.3.4. Term</a></li>
<li><a href="#orgheadline26">5.3.5. Display</a></li>
</ul>
</li>
<li><a href="#orgheadline28">5.4. Aliasing</a></li>
<li><a href="#orgheadline29">5.5. Ledger</a></li>
<li><a href="#orgheadline30">5.6. Functions</a></li>
<li><a href="#orgheadline31">5.7. Source common files</a></li>
<li><a href="#orgheadline32">5.8. Line Editor</a></li>
<li><a href="#orgheadline33">5.9. Completion Widgets</a></li>
<li><a href="#orgheadline34">5.10. Completion System</a></li>
<li><a href="#orgheadline35">5.11. Zsh Modules</a></li>
<li><a href="#orgheadline36">5.12. Others</a></li>
</ul>
</li>
<li><a href="#orgheadline51">6. Common</a>
<ul>
<li><a href="#orgheadline38">6.1. Preamble</a></li>
<li><a href="#orgheadline39">6.2. Default editor</a></li>
<li><a href="#orgheadline40">6.3. Aliases</a></li>
<li><a href="#orgheadline41">6.4. Emacs / Org</a></li>
<li><a href="#orgheadline42">6.5. Grep</a></li>
<li><a href="#orgheadline43">6.6. Pager</a></li>
<li><a href="#orgheadline44">6.7. GraphicsMagick</a></li>
<li><a href="#orgheadline45">6.8. MCit tools</a></li>
<li><a href="#orgheadline46">6.9. Next</a></li>
<li><a href="#orgheadline47">6.10. Functions</a></li>
<li><a href="#orgheadline48">6.11. Emacsclient</a></li>
<li><a href="#orgheadline49">6.12. Other</a></li>
<li><a href="#orgheadline50">6.13. Postamble</a></li>
</ul>
</li>
<li><a href="#orgheadline52">7. InputRC</a></li>
<li><a href="#orgheadline53">8. Install environment</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline1" class="outline-2">
<h2 id="orgheadline1"><span class="section-number-2">1</span> Documentation</h2>
<div class="outline-text-2" id="text-1">
<p><a href="http://www.bash2zsh.com/zsh_refcard/refcard.pdf">Zsh Reference Card</a></p>
</div>
</div>
<div id="outline-container-orgheadline4" class="outline-2">
<h2 id="orgheadline4"><span class="section-number-2">2</span> Startup files</h2>
<div class="outline-text-2" id="text-2">
<p>There are three <b>sorts of shells</b>:</p>
<ul class="org-ul">
<li>
<p>(interactive) <b>login</b> (for which <code>c:/cygwin/etc/profile</code> and <code>.profile</code> are read, which sources <code>.bashrc</code> as well)</p>
<p><b>Note --</b> Launching Cygwin Terminal (login shell) does not load <code>.bashrc</code> on its own, it only loads <code>.bash_profile</code>. Hence, the need to have a <code>.bash_profile</code> sourcing <code>.bashrc</code>…</p>
</li>
<li><b>interactive</b> (non-login) (for which <code>.bashrc</code> is read)</li>
<li>
<p>normal shell, i.e. one that's running a <b>script</b> (bash does not execute any initialization file in this case!)</p>
<p><code>$tty</code> is empty.</p>
</li>
</ul>
<p>We just let <code>.profile</code> also read <code>.bashrc</code> and put everything in <code>.bashrc</code>.</p>
<p><b>Read</b> <a href="http://shreevatsa.wordpress.com/2008/03/30/zshbash-startup-files-loading-order-bashrc-zshrc-etc/">Zsh/Bash startup files loading order</a>:</p>
<ul class="org-ul">
<li>For bash, put stuff in <code>~/.bashrc</code>, and make <code>~/.bash_profile</code> source it.</li>
<li>For zsh, put stuff in <code>~/.zshrc</code>, which is always executed.</li>
</ul>
<p>To recover the default bash configuration files, get their copy from <code>/etc/skel</code>.</p>
<p>If you get a couple of "command not found" errors and a corrupt prompt at startup, then your <code>.bashrc</code> is probably in Windows text format (<code>\r\n</code> line endings). Make sure your editor is in Unix format when creating text files.</p>
</div>
<div id="outline-container-orgheadline2" class="outline-3">
<h3 id="orgheadline2"><span class="section-number-3">2.1</span> What to put where?</h3>
<div class="outline-text-3" id="text-2-1">
<p>Login shell runs .profile (or .bash_profile or .bash_login) on startup. Set your env variables in there, cuz sub-shells will inherit the env vars. Then make .profile run your .bashrc:</p>
<div class="org-src-container">
<pre class="src src-shell">
. .bashrc
</pre></div>
<p>Interactive runs .bashrc. Since it inherits envs, but not aliases, put your aliases in this file.</p>
<p>Shell scripts, cron jobs, and the like, run with a bare shell: no bashrc or profiles are run. No kidding you get 4 env vars set, the bare minimum. Therefore your PATH won't work very well so you often have to give an abs pathname like in crontab:</p>
<div class="org-src-container">
<pre class="src src-shell">
right: 0 0 * * 2 /usr/sbin/apachectl restart
wrong: 0 0 * * 2 apachectl restart
</pre></div>
<p>From <a href="https://www.linuxquestions.org/questions/linux-general-1/difference-between-normal-shell-and-login-shell-14983/#post4828786">https://www.linuxquestions.org/questions/linux-general-1/difference-between-normal-shell-and-login-shell-14983/#post4828786</a></p>
</div>
</div>
<div id="outline-container-orgheadline3" class="outline-3">
<h3 id="orgheadline3"><span class="section-number-3">2.2</span> Note</h3>
<div class="outline-text-3" id="text-2-2">
<p>In <code>c:/cygwin/etc/profile</code>,</p>
<ul class="org-ul">
<li>
<p><code>/usr/local/bin</code> is appended to the <code>PATH</code>!!</p>
<p>And, except when root, it is almost always wrong to have <code>/usr/local/bin</code> after any system path.</p>
</li>
<li><code>TZ</code> (time zone) is set… which gives wrong times (1 hour difference) in Emacs when called from <code>c:/cygwin/Cygwin.bat</code>!!</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgheadline5" class="outline-2">
<h2 id="orgheadline5"><span class="section-number-2">3</span> Terminals</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li><code>dumb</code></li>
<li><code>cygwin</code></li>
<li><code>emacs</code></li>
<li><code>screen</code></li>
<li><code>xterm</code></li>
<li><code>xterm-256color</code> (choose this if Emacs looks ugly in a terminal)</li>
<li><code>eterm-color</code></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline19" class="outline-2">
<h2 id="orgheadline19"><span class="section-number-2">4</span> Bash specific</h2>
<div class="outline-text-2" id="text-4">
<p>Le <code>!</code> en shell permet plein de trucs sympa.</p>
<ul class="org-ul">
<li><code>!!</code> refait la dernière commande</li>
<li><code>!cmd</code> refait la dernière commande commençant par <code>cmd</code></li>
<li><code>!cmd:p</code> permet de visualiser sans éxecuter la dernière commande commençant par <code>cmd</code></li>
<li><code>!$</code> est le dernier mot du ligne de commande précédent</li>
<li><code>!cmd:$</code> est le dernier mot du dernier ligne de commande commençant par <code>cmd</code></li>
<li><code>!*</code> est l'ensemble de la dernière ligne de commande à part le premier mot</li>
</ul>
<p>Pourquoi ce dernier est-il utile ? Pense à ceci :</p>
<div class="org-src-container">
<pre class="src src-shell">
$ gm convret -size 120x120 input.png -resize 120x120 -draw <span class="org-string">"gravity southeast text 0,0 'Dave Neary'"</span> output.jpg
bash: convret: command not found
$ gm convert !*
</pre></div>
</div>
<div id="outline-container-orgheadline6" class="outline-3">
<h3 id="orgheadline6"><span class="section-number-3">4.1</span> Profile</h3>
<div class="outline-text-3 org-src-container" id="text-4-1">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">User dependent .bash_profile file</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">source the user's .bashrc if it exists</span>
<span class="org-keyword">if</span> [ -f <span class="org-string">"${HOME}/.bashrc"</span> ] ; <span class="org-keyword">then</span>
  <span class="org-builtin">source</span> <span class="org-string">"${HOME}/.bashrc"</span>
<span class="org-keyword">fi</span>
</pre></div>
</div>
<div id="outline-container-orgheadline7" class="outline-3">
<h3 id="orgheadline7"><span class="section-number-3">4.2</span> Preamble</h3>
<div class="outline-text-3" id="text-4-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgsrcblock1">
(format-time-string <span class="org-string">"%Y"</span>)
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">## </span><span class="org-comment">.bashrc --- Bourne Again Shell configuration file (for interactive shells)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Copyright (C) 2003-2015 Fabrice Niessen</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Keywords: bash, dotfile, config</span>

<span class="org-comment-delimiter">#    </span><span class="org-comment">_               _</span>
<span class="org-comment-delimiter">#   </span><span class="org-comment">| |__   __ _ ___| |__  _ __ ___</span>
<span class="org-comment-delimiter">#   </span><span class="org-comment">| '_ \ / _` / __| '_ \| '__/ __|</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">_| |_) | (_| \__ \ | | | | | (__</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">(_)_.__/ \__,_|___/_| |_|_|  \___|</span>
<span class="org-comment-delimiter">#</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This file is free software; you can redistribute it and/or</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">modify it under the terms of the GNU General Public License as</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">published by the Free Software Foundation; either version 2 of</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">the License, or (at your option) any later version.</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This file is distributed in the hope that it will be</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">useful, but WITHOUT ANY WARRANTY; without even the implied</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">PURPOSE.  See the GNU General Public License for more details.</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">You should have received a copy of the GNU General Public</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">License along with this file; if not, write to the Free</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">MA 02111-1307, USA.</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">* Code:</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">modify to taste</span>
</pre></div>
<p>I think the following is important for tools such as <code>rsync</code> (and Emacs Tramp?)…</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">if not running interactively, don't do anything</span>
[[ <span class="org-string">"$-"</span> != *i* ]] &amp;&amp; <span class="org-keyword">return</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline13" class="outline-3">
<h3 id="orgheadline13"><span class="section-number-3">4.3</span> Variables</h3>
<div class="outline-text-3" id="text-4-3"></div>
<div id="outline-container-orgheadline8" class="outline-4">
<h4 id="orgheadline8"><span class="section-number-4">4.3.1</span> Search path</h4>
<div class="outline-text-4" id="text-4-3-1">
<p>Where to look for executable files.</p>
<p>The global search PATH is defined in the file `/etc/environment'</p>
<div class="note">
<p><code>PATH</code> should already be marked as exported, so reexporting is not needed.</p>
</div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">specify the directories that the shell is to look through to find a</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">command. These directories are searched in the order in which they appear.</span>
<span class="org-keyword">for</span> MAYBE_PATH<span class="org-keyword"> in</span> <span class="org-string">"$HOME/bin"</span> <span class="org-sh-escaped-newline">\</span>
                  <span class="org-string">"$HOME/expect"</span> <span class="org-sh-escaped-newline">\</span>
                  <span class="org-string">"$HOME/winbin"</span>
<span class="org-keyword">do</span>
    <span class="org-keyword">if</span> [ -d <span class="org-string">"$MAYBE_PATH"</span> ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">PATH</span>=<span class="org-string">"$MAYBE_PATH:$PATH"</span>
    <span class="org-keyword">fi</span>
<span class="org-keyword">done</span>
</pre></div>
<p>By default, the <code>root</code> shell does not load commands from the current location. If you're root and if you trust those commands, type <code>./whatever-command</code> instead.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">add the current directory as last component in the search path</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">(not to include for root, for security reasons)</span>
<span class="org-keyword">if</span> [ <span class="org-negation-char">!</span> <span class="org-string">"$(id -u)"</span> = <span class="org-string">"0"</span> ]; <span class="org-keyword">then</span>
    <span class="org-variable-name">PATH</span>=<span class="org-string">"$PATH:."</span>
<span class="org-keyword">fi</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline9" class="outline-4">
<h4 id="orgheadline9"><span class="section-number-4">4.3.2</span> Prompt</h4>
<div class="outline-text-4" id="text-4-3-2">
<p>Appearance of the prompt.</p>
<p>Note <code>\[...\]</code> used by the shell to count proper length.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">*** Controlling the Prompt</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">regular colors</span>
<span class="org-variable-name">green</span>=<span class="org-string">"\[\e[0;32m\]"</span>
<span class="org-variable-name">yellow</span>=<span class="org-string">"\[\e[0;33m\]"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">bold colors</span>
<span class="org-variable-name">BLACK</span>=<span class="org-string">"\[\e[1;30m\]"</span>
<span class="org-variable-name">RED</span>=<span class="org-string">"\[\e[1;31m\]"</span>
<span class="org-variable-name">GREEN</span>=<span class="org-string">"\[\e[1;32m\]"</span>

<span class="org-variable-name">reset</span>=<span class="org-string">"\[\e[0m\]"</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">**** PS1 --- Default interaction prompt</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">**** PS2 --- Continuation interactive prompt</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">**** PS3 --- Prompt used by "select" inside shell script</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">**** PS4 --- Used by "set -x" to prefix tracing output</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">get line numbers when you run with `-x'</span>
<span class="org-variable-name">PS4</span>=<span class="org-string">'+'</span>${<span class="org-variable-name">green</span>}<span class="org-string">'[$0:${LINENO}]+ '</span>${<span class="org-variable-name">reset</span>}
<span class="org-comment-delimiter"># </span><span class="org-comment">single quotes (otherwise, this line number is taken)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">If you are looking at performance issues, put `$SECONDS' in the PS4 prompt</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">as well</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">**** PROMPT_COMMAND</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">to be called just before the prompt is printed</span>
<span class="org-function-name">precmd</span> ()
{
    <span class="org-variable-name">RET</span>=$<span class="org-variable-name">?</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">set a color prompt (unless in Emacs)</span>
    <span class="org-keyword">case</span> $<span class="org-variable-name">TERM</span><span class="org-keyword"> in</span>
        cygwin|xterm*|rxvt-unicode)
            <span class="org-builtin">local</span> <span class="org-variable-name">color_prompt</span>=yes
            ;;
        dumb)
            <span class="org-comment-delimiter"># </span><span class="org-comment">`M-x shell' under Cygwin Emacs</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">`M-x eshell' under EmacsW32</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">Tramp</span>
            <span class="org-builtin">local</span> <span class="org-variable-name">color_prompt</span>=no
            ;;
        emacs)
            <span class="org-comment-delimiter"># </span><span class="org-comment">`M-x shell' under EmacsW32</span>
            <span class="org-builtin">local</span> <span class="org-variable-name">color_prompt</span>=no
            ;;
        eterm-color)
            <span class="org-comment-delimiter"># </span><span class="org-comment">`M-x term' under Cygwin Emacs</span>
            <span class="org-builtin">local</span> <span class="org-variable-name">color_prompt</span>=no
            ;;
    <span class="org-keyword">esac</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">colorful prompt, based on whether the previous command succeeded or not</span>
    <span class="org-keyword">if</span> [ $<span class="org-variable-name">RET</span> -eq 0 ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">HILIT_RET</span>=${<span class="org-variable-name">GREEN</span>}
    <span class="org-keyword">else</span>
        <span class="org-variable-name">HILIT_RET</span>=${<span class="org-variable-name">RED</span>}
    <span class="org-keyword">fi</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">replace the `$HOME' prefix by `~' in the current directory</span>
    <span class="org-keyword">if</span> [ <span class="org-string">"$HOME"</span> = <span class="org-string">"${PWD:0:${#HOME}}"</span> ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">myPWD</span>=<span class="org-string">"~${PWD:${#HOME}}"</span>
    <span class="org-keyword">else</span>
        <span class="org-variable-name">myPWD</span>=$<span class="org-variable-name">PWD</span>
    <span class="org-keyword">fi</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">how many characters of the path should be kept</span>
    <span class="org-builtin">local</span> <span class="org-variable-name">pwd_max_length</span>=15

    <span class="org-keyword">if</span> [ ${#<span class="org-variable-name">myPWD</span>} -gt $<span class="org-variable-name">pwd_max_length</span> ]; <span class="org-keyword">then</span>
        <span class="org-builtin">local</span> <span class="org-variable-name">pwd_offset</span>=$(( ${#<span class="org-variable-name">myPWD</span>} - $<span class="org-variable-name">pwd_max_length</span> ))
        <span class="org-variable-name">myPWD</span>=<span class="org-string">"...${myPWD:$pwd_offset:$pwd_max_length}"</span>
    <span class="org-keyword">fi</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment">prompt character</span>
    <span class="org-keyword">if</span> [ <span class="org-string">"$USERNAME"</span> = <span class="org-string">"root"</span> ]; <span class="org-keyword">then</span>
        <span class="org-builtin">local</span> <span class="org-variable-name">PROMPTCHAR</span>=<span class="org-string">"#"</span>
    <span class="org-keyword">else</span>
        <span class="org-builtin">local</span> <span class="org-variable-name">PROMPTCHAR</span>=<span class="org-string">"$"</span>
    <span class="org-keyword">fi</span>

    <span class="org-keyword">if</span> [ <span class="org-string">"$color_prompt"</span> = <span class="org-string">"yes"</span> ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">PS1</span>=<span class="org-string">"${green}\u@\h${BLACK}:${yellow}${myPWD}${HILIT_RET} ${RET}${reset}${PROMPTCHAR} "</span>
    <span class="org-keyword">else</span>
        <span class="org-variable-name">PS1</span>=<span class="org-string">"\u@\h:${myPWD} ${RET}${PROMPTCHAR} "</span>
    <span class="org-keyword">fi</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">execute the content of the `PROMPT_COMMAND' just before displaying the `PS1'</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">variable (but don't confuse Tramp)</span>
[ $<span class="org-variable-name">TERM</span> = <span class="org-string">"dumb"</span> ] || <span class="org-variable-name">PROMPT_COMMAND</span>=precmd
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline10" class="outline-4">
<h4 id="orgheadline10"><span class="section-number-4">4.3.3</span> Command history</h4>
<div class="outline-text-4" id="text-4-3-3">
<p>Access and modify commands that you had previously typed at the command line.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">history</span>
<span class="org-variable-name">HISTFILE</span>=$<span class="org-variable-name">HOME</span>/.bash_history <span class="org-comment-delimiter"># </span><span class="org-comment">if paranoiac, `/dev/null'</span>
<span class="org-variable-name">HISTSIZE</span>=1000
<span class="org-variable-name">HISTFILESIZE</span>=1000
<span class="org-variable-name">HISTIGNORE</span>=<span class="org-string">"&amp;:[bf]g:exit"</span>
<span class="org-variable-name">HISTCONTROL</span>=ignoredups
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline11" class="outline-4">
<h4 id="orgheadline11"><span class="section-number-4">4.3.4</span> Term</h4>
</div>
<div id="outline-container-orgheadline12" class="outline-4">
<h4 id="orgheadline12"><span class="section-number-4">4.3.5</span> Display</h4>
</div>
</div>
<div id="outline-container-orgheadline14" class="outline-3">
<h3 id="orgheadline14"><span class="section-number-3">4.4</span> Code</h3>
<div class="outline-text-3" id="text-4-4">
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** Source global rc file (if any)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">source global definitions if the session is interactive (to avoid problems</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">like "stdin: is not a tty" when ssh'ing to a remote machine)</span>
<span class="org-keyword">if</span> ([ $(expr index <span class="org-string">"$-"</span> i) -ne 0 ] &amp;&amp; [ -f /etc/bashrc ]); <span class="org-keyword">then</span>
    . /etc/bashrc
<span class="org-keyword">fi</span>
</pre></div>
<p>A common cause is <code>mesg y</code> in <code>/etc/bashrc</code> on the remote machine, hence the user has to try avoiding sourcing it (on the <b>remote</b> machine) in non-interactive sessions.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** Default permissions</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">permissions on newly created files</span>
<span class="org-builtin">umask</span> 022 <span class="org-comment-delimiter"># </span><span class="org-comment">prevent new dirs and files from being group and world writable</span>

<span class="org-keyword">if</span> [ <span class="org-string">"$USERNAME"</span> = <span class="org-string">"root"</span> ]; <span class="org-keyword">then</span>
    <span class="org-builtin">umask</span> 077  <span class="org-comment-delimiter"># </span><span class="org-comment">stricter</span>
<span class="org-keyword">fi</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** Shell options</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">correct minor misspellings of cd pathnames</span>
shopt -s cdspell
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline15" class="outline-3">
<h3 id="orgheadline15"><span class="section-number-3">4.5</span> Next</h3>
<div class="outline-text-3" id="text-4-5">
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 5 (info "(bashref)Shell Variables")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">set MANPATH so it includes user's private man if it exists</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">do the same with MANPATH</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">if [ -d $HOME/man ]; then</span>
<span class="org-comment-delimiter">#    </span><span class="org-comment">MANPATH=$HOME/man:"${MANPATH}"</span>
<span class="org-comment-delimiter">#    </span><span class="org-comment">export MANPATH</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">fi</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">LANG="en_US.utf8"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">LC_CTYPE="en_US.utf8"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">LC_ALL="C"   # fixes the problem of strange characters in the man page</span>
<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> These should be set in `/etc/default/locale', via `sudo update-locale'</span>

<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> Set DISPLAY?</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">colon separated list of directories to search for manual pages</span>
<span class="org-comment-delimiter">#</span><span class="org-comment">ifnset MANPATH "/usr/man"</span>
    <span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> don't define it like that: does not work under Ubuntu!</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">See `/etc/manpath.config'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Info readers (standalone + Emacs Info mode)</span>
<span class="org-variable-name">INFOPATH</span>=<span class="org-string">"/usr/share/info:$INFOPATH"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">include a trailing colon on `INFOPATH' to concatenate the Emacs</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">`Info-default-directory-list' when searching for info files</span>
<span class="org-variable-name">INFOPATH</span>=<span class="org-string">"$HOME/src/emacs-w3m/doc:$INFOPATH"</span>
<span class="org-variable-name">INFOPATH</span>=<span class="org-string">"$HOME/src/gnus/texi:$INFOPATH"</span>
<span class="org-variable-name">INFOPATH</span>=<span class="org-string">"$HOME/Downloads/emacs/site-lisp/auctex-11.86/doc:$INFOPATH"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">INFOPATH="$HOME/texlive/2014/texmf/doc/info:$INFOPATH"</span>
<span class="org-variable-name">INFOPATH</span>=<span class="org-string">"$HOME/Public/Repositories/org-mode/doc:$INFOPATH"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">Functions to help us manage environment variables</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">setenv [VAR] [value] - set environment variable</span>
<span class="org-function-name">setenv</span> () { <span class="org-builtin">eval</span> $<span class="org-variable-name">1</span>=<span class="org-string">"\$2"</span> export $<span class="org-variable-name">1</span>; }

<span class="org-comment-delimiter"># </span><span class="org-comment">unsetenv [VAR] - unset environment variable</span>
<span class="org-function-name">unsetenv</span> () { <span class="org-builtin">unset</span> <span class="org-string">"$@"</span>; }

<span class="org-comment-delimiter"># </span><span class="org-comment">ifnset [VAR] [value] - set environment variable only if not set yet</span>
<span class="org-function-name">ifnset</span> () { <span class="org-builtin">eval</span> $<span class="org-variable-name">1</span>=<span class="org-string">\$</span>{<span class="org-variable-name">$</span>1-<span class="org-string">"\$2"</span>} <span class="org-builtin">export</span> $<span class="org-variable-name">1</span>; }

<span class="org-comment-delimiter"># </span><span class="org-comment">ifnull [VAR] [value] - set environment variable if not set yet or if NULL</span>
<span class="org-function-name">ifnull</span> () { <span class="org-builtin">eval</span> $<span class="org-variable-name">1</span>=<span class="org-string">\$</span>{<span class="org-variable-name">$</span>1:-<span class="org-string">"\$2"</span>} <span class="org-builtin">export</span> $<span class="org-variable-name">1</span>; }

<span class="org-comment-delimiter"># </span><span class="org-comment">append [VAR] [path] - append path separated by `:'</span>
<span class="org-function-name">append</span> () { <span class="org-builtin">eval</span> $<span class="org-variable-name">1</span>=<span class="org-string">\$</span>{<span class="org-variable-name">$</span>1:+<span class="org-string">\$</span><span class="org-variable-name">$</span>1${<span class="org-variable-name">2</span>:+:}}<span class="org-string">\$</span><span class="org-variable-name">2</span> export $<span class="org-variable-name">1</span>; }

<span class="org-comment-delimiter"># </span><span class="org-comment">prepend [VAR] [path] - prepend path separated by `:'</span>
<span class="org-function-name">prepend</span> () { <span class="org-builtin">eval</span> $<span class="org-variable-name">1</span>=<span class="org-string">\$</span><span class="org-variable-name">2</span><span class="org-string">\$</span>{<span class="org-variable-name">$</span>1:+${<span class="org-variable-name">2</span>:+:}<span class="org-string">\$</span><span class="org-variable-name">$</span>1} <span class="org-builtin">export</span> $<span class="org-variable-name">1</span>; }

<span class="org-comment-delimiter"># </span><span class="org-comment">showvalue [VAR]... - print out the value of variables given their name</span>
<span class="org-function-name">showvalue</span> () { <span class="org-keyword">for</span> i<span class="org-keyword"> in</span> $<span class="org-variable-name">*</span>; <span class="org-keyword">do </span><span class="org-builtin">eval</span> echo <span class="org-string">"$i = \\\`\$$i\'"</span>; <span class="org-keyword">done</span>; }
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline16" class="outline-3">
<h3 id="orgheadline16"><span class="section-number-3">4.6</span> Source common files</h3>
<div class="outline-text-3" id="text-4-6">
<p><code>.commonshrc</code> contains miscellaneous definitions common to Bash and Zsh.</p>
<p>An <b>alias</b> is a simple string substitution.</p>
<p>By default, it is <b>not expanded in non-interactive shells</b> (scripts, and even functions called in an interactive shell!).</p>
<p>In general, it should not do more than <b>change the default options of a command</b>.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 4.2 or 6.6 Aliases</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">source common definitions</span>
<span class="org-keyword">if</span> [ -r <span class="org-string">"$HOME/.commonshrc"</span> ]; <span class="org-keyword">then</span>
    . $<span class="org-variable-name">HOME</span>/.commonshrc
<span class="org-keyword">fi</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline17" class="outline-3">
<h3 id="orgheadline17"><span class="section-number-3">4.7</span> Next</h3>
<div class="outline-text-3 org-src-container" id="text-4-7">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">ALTER the ORIGINAL meaning of existing commands (that scripts don't</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">expect to see modified!)</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">df</span>=<span class="org-string">'df -kTh'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">du</span>=<span class="org-string">'du -kh'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">cp</span>=<span class="org-string">'cp -i'</span>   <span class="org-comment-delimiter"># </span><span class="org-comment">confirm copy over an existing file</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">mv</span>=<span class="org-string">'mv -i'</span>   <span class="org-comment-delimiter"># </span><span class="org-comment">confirm move over an existing file</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">rm</span>=<span class="org-string">'rm -i'</span>   <span class="org-comment-delimiter"># </span><span class="org-comment">confirm removing file (prevent some accidental mistakes)</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">ssh</span>=<span class="org-string">"ssh -C"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">more</span>=<span class="org-string">"less"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">rmdir</span>=<span class="org-string">"rm -fr"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">path</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">where</span>=<span class="org-string">'type -all'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">start up Windows applications associated with a particular file extension</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">directly from the Bash prompt</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">start</span>=<span class="org-string">"cmd /c start"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">start</span>=<span class="org-string">"cygstart"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">under Cygwin</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">lo</span>=<span class="org-string">"locate -i"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">case insensitive search</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">lg</span>=<span class="org-string">"locate -r '.*' | grep -i"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">mkall</span>=<span class="org-string">"./configure &amp;&amp; make &amp;&amp; sudo make install"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">tvm</span>=<span class="org-string">"tail -f /var/log/messages"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">sudo'ers</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">root</span>=<span class="org-string">"su - root"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">force the radio to always sync at 2 Mbps, even if other speeds are available</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">iwconfigslow</span>=<span class="org-string">"sudo iwconfig eth1 rate 2M"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">shortcuts</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">c</span>=<span class="org-string">"clear"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">E</span>=<span class="org-string">"env | sort"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">h</span>=<span class="org-string">"history 25"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">j</span>=<span class="org-string">"jobs -l"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">m</span>=$<span class="org-variable-name">PAGER</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">p</span>=$<span class="org-variable-name">PAGER</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">se</span>=<span class="org-string">"sudoedit"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">X</span>=<span class="org-string">"ssh-agent startx &amp;"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">z</span>=<span class="org-string">"suspend"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">misc commands</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">dos2unix</span>=<span class="org-string">"sed s/</span>
<span class="org-string">//g"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">unix2dos</span>=<span class="org-string">"sed s/\$/</span>
<span class="org-string">/"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">hgrep</span>=<span class="org-string">"history | grep"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">keyon</span>=<span class="org-string">"ssh-add -t 10800"</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">add identity</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">keyoff</span>=<span class="org-string">"ssh-add -D"</span>       <span class="org-comment-delimiter"># </span><span class="org-comment">remove all identities</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">keylist</span>=<span class="org-string">"ssh-add -l"</span>      <span class="org-comment-delimiter"># </span><span class="org-comment">list all identities</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">kill9</span>=<span class="org-string">"kill -9"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">make an extract function!</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">tgz</span>=<span class="org-string">"tar -zxvf"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">tbz2</span>=<span class="org-string">"tar -jxvf"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">nfiles</span>=<span class="org-string">"find . -type f | wc -l"</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">ports</span>=<span class="org-string">"netstat -alpe --ip"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">most used programs</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">web</span>=<span class="org-string">"firefox &amp;"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">alias scan="nmap -sS -O"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">nm</span>=<span class="org-string">"nmap -sS -O -PI -PT"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">portscan</span>=<span class="org-string">"nmap -sT -PT -R "</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">anonymous wget (using Privoxy and Tor)</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">aget</span>=<span class="org-string">'wget --execute "http_proxy = http://127.0.0.1:8118" --proxy'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">mirror</span>=<span class="org-string">"wget -v --tries=0 --continue --force-directories --mirror --no-parent"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">ngrep -i -w 'user|pass' port 110</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ngrep -d eth0 -i 'USER|PASS' tcp port 80</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ngrep google port 80</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ngrep -i 'rcpt to|mail from' tcp port smtp</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ngrep -q -t -wi "login" port 23</span>


<span class="org-comment-delimiter">#</span><span class="org-comment">** 8.6 Programmable Completion</span>

complete -A helptopic help
complete -A hostname ssh telnet nmap rlogin ftp ping host traceroute nslookup rexec


<span class="org-comment-delimiter">#</span><span class="org-comment">** Misc functions</span>

<span class="org-function-name">saneperms</span> ()
{
    find . -type d -print0 | xargs -0 chmod 755
    find . -type f -print0 | xargs -0 chmod ${<span class="org-variable-name">1</span>:=644}
}


<span class="org-comment-delimiter"># </span><span class="org-comment"># search for various types or README file in dir and display them in $PAGER</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">readme ()</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">{</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">local files</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">files=(./(#i)*(read*me|lue*m(in|)ut)*(ND))</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">if (($#files)); then</span>
<span class="org-comment-delimiter">#         </span><span class="org-comment">$PAGER $files</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">else</span>
<span class="org-comment-delimiter">#         </span><span class="org-comment">print 'No README files.'</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">fi</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">}</span>

<span class="org-comment-delimiter"># </span><span class="org-comment"># Get a file's basename, dirname, extension, etc</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># get extension; everything after last '.'</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ext=${file##*.}</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># basename</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">basename=`basename "$file"`</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># everything after last '/'</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">basename=${file##*/}</span>
<span class="org-comment-delimiter">#</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># dirname</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">dirname=`dirname "$file"`</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># everything before last '/'</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">basename=${file%/*}</span>

<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> If possible, get the lines colored (exe in green) or suffixed (`*' for</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">exe, `/' for dir, etc.)</span>
<span class="org-function-name">ff</span> ()
{
    find . -name $<span class="org-variable-name">@</span> -print 2&gt;&amp;1 | grep -v <span class="org-string">"find:"</span>
}

<span class="org-function-name">safetmp</span> ()
{
    test -d $<span class="org-variable-name">HOME</span> || <span class="org-keyword">exit</span> 1
    test -d $<span class="org-variable-name">HOME</span>/tmp || mkdir $<span class="org-variable-name">HOME</span>/tmp
    <span class="org-builtin">echo</span> $<span class="org-variable-name">HOME</span>/tmp/safetmp.$(hostname).$(date +%s).$<span class="org-variable-name">$</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">Copies my public key to the given server</span>
<span class="org-function-name">sendkey</span> ()
{
    <span class="org-builtin">local</span> <span class="org-variable-name">HOSTNAME</span>=<span class="org-string">"$*"</span>
    scp $<span class="org-variable-name">HOME</span>/.ssh/id_rsa.pub $<span class="org-variable-name">USER</span>@$<span class="org-variable-name">HOSTNAME</span>:/home/$<span class="org-variable-name">DOMAIN</span>/$<span class="org-variable-name">USER</span>/.ssh/authorized_keys
    <span class="org-comment-delimiter"># </span><span class="org-comment">The PuTTY developers strongly recommend you use RSA</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">Copies my `.bashrc' to the given server</span>
<span class="org-function-name">sendbash</span> ()
{
    <span class="org-builtin">local</span> <span class="org-variable-name">HOSTNAME</span>=<span class="org-string">"$*"</span>
    scp $<span class="org-variable-name">HOME</span>/.bashrc $<span class="org-variable-name">USER</span>@$<span class="org-variable-name">HOSTNAME</span>:/home/$<span class="org-variable-name">DOMAIN</span>/$<span class="org-variable-name">USER</span>/.bashrc
}

<span class="org-comment-delimiter"># </span><span class="org-comment">Copies my public key and bashrc to the given server</span>
<span class="org-function-name">rsetup</span> ()
{
    <span class="org-builtin">local</span> <span class="org-variable-name">HOSTNAME</span>=<span class="org-string">"$*"</span>
    sendkey $<span class="org-variable-name">HOSTNAME</span>
    sendbash $<span class="org-variable-name">HOSTNAME</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">gpg</span>
<span class="org-function-name">searchkey</span> ()
{
    gpg --keyserver pgp.mit.edu --fingerprint --search-key <span class="org-string">"$@"</span>;
}

<span class="org-comment-delimiter">#</span><span class="org-comment">*** GPG functions</span>

<span class="org-function-name">encrypt</span> ()
{
    <span class="org-comment-delimiter"># </span><span class="org-comment">Use ascii armor</span>
    gpg -ac --no-options <span class="org-string">"$1"</span>
}

<span class="org-function-name">bencrypt</span> ()
{
    <span class="org-comment-delimiter"># </span><span class="org-comment">No ascii armor</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Encrypt binary data. jpegs/gifs/vobs/etc.</span>
    gpg -c --no-options <span class="org-string">"$1"</span>
}

<span class="org-function-name">decrypt</span> ()
{
    gpg --no-options <span class="org-string">"$1"</span>
}

<span class="org-function-name">pe</span> ()
{
<span class="org-comment-delimiter"># </span><span class="org-comment">Passphrase encryption program</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Created by Dave Crouse 01-13-2006</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Reads input from text editor and encrypts to screen.</span>
    clear
    <span class="org-builtin">echo</span> <span class="org-string">"         Passphrase Encryption Program"</span>;
    <span class="org-builtin">echo</span> <span class="org-string">"--------------------------------------------------"</span>; <span class="org-builtin">echo</span> <span class="org-string">""</span>;
    <span class="org-builtin">which</span> $<span class="org-variable-name">EDITOR</span> &amp;&gt;/dev/null
    <span class="org-keyword">if</span> [ $<span class="org-variable-name">?</span> != <span class="org-string">"0"</span> ]; <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"It appears that you do not have a text editor set in your .bashrc file."</span>;
        <span class="org-builtin">echo</span> <span class="org-string">"What editor would you like to use ? "</span> ;
        <span class="org-builtin">read</span> EDITOR ; <span class="org-builtin">echo</span> <span class="org-string">""</span>;
    <span class="org-keyword">fi</span>
    <span class="org-builtin">echo</span> <span class="org-string">"Enter the name/comment for this message :"</span>
    <span class="org-builtin">read</span> comment
    $<span class="org-variable-name">EDITOR</span> passphraseencryption
    gpg --armor --comment <span class="org-string">"$comment"</span> --no-options --output
    passphraseencryption.gpg --symmetric passphraseencryption
    shred -u passphraseencryption ; clear
    <span class="org-builtin">echo</span> <span class="org-string">"Outputting passphrase encrypted message"</span>; <span class="org-builtin">echo</span> <span class="org-string">""</span> ; <span class="org-builtin">echo</span> <span class="org-string">""</span> ;
    cat passphraseencryption.gpg ; <span class="org-builtin">echo</span> <span class="org-string">""</span> ; <span class="org-builtin">echo</span> <span class="org-string">""</span> ;
    shred -u passphraseencryption.gpg ;
    <span class="org-builtin">read</span> -p <span class="org-string">"Hit enter to exit"</span> temp; clear
}

<span class="org-function-name">keys</span> ()
{
    <span class="org-comment-delimiter"># </span><span class="org-comment">Opens up kgpg keymanager</span>
    kgpg -k
}

<span class="org-function-name">encryptfile</span> ()
{
    zenity --title=<span class="org-string">"zcrypt: Select a file to encrypt"</span> --file-selection &gt; zcrypt
    <span class="org-variable-name">encryptthisfile</span>=<span class="org-sh-quoted-exec">`cat zcrypt`</span>;rm zcrypt
    <span class="org-comment-delimiter"># </span><span class="org-comment">Use ascii armor</span>
    <span class="org-comment-delimiter">#  </span><span class="org-comment">--no-options (for NO gui usage)</span>
    gpg -acq --yes ${<span class="org-variable-name">encryptthisfile</span>}
    zenity --info --title <span class="org-string">"File Encrypted"</span> --text <span class="org-string">"$encryptthisfile has been encrypted"</span>
}

<span class="org-function-name">decryptfile</span> ()
{
    zenity --title=<span class="org-string">"zcrypt: Select a file to decrypt"</span> --file-selection &gt; zcrypt
    <span class="org-variable-name">decryptthisfile</span>=<span class="org-sh-quoted-exec">`cat zcrypt`</span>;rm zcrypt
    <span class="org-comment-delimiter"># </span><span class="org-comment">NOTE: This will OVERWRITE existing files with the same name !!!</span>
    gpg --yes -q ${<span class="org-variable-name">decryptthisfile</span>}
    zenity --info --title <span class="org-string">"File Decrypted"</span> --text <span class="org-string">"$encryptthisfile has been decrypted"</span>
}


<span class="org-comment-delimiter"># </span><span class="org-comment"># have one SSH agent ready at all times</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">if [ "$SSH_AUTH_SOCK" = "" ]; then</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment"># check to see if there's an ssh-agent running</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">eval $(ssh-agent)</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">ssh-add</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">fi</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">*** Unison</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">unison the current working directory only</span>
<span class="org-function-name">uwd</span> ()
{
    <span class="org-variable-name">p</span>=$(<span class="org-builtin">pwd</span> -P)
    <span class="org-variable-name">p</span>=${<span class="org-variable-name">p</span>#*$<span class="org-variable-name">HOME</span>/my-unison-root/}
    <span class="org-variable-name">p</span>=${<span class="org-variable-name">p</span>#*$<span class="org-variable-name">HOME</span>/my-unison-root}

    <span class="org-keyword">if</span> [ -d <span class="org-string">"$HOME/my-unison-root/$p"</span> ]; <span class="org-keyword">then</span>
        unison profile-name-for-uwd -path <span class="org-string">"$p"</span>
    <span class="org-keyword">else</span>
        <span class="org-builtin">echo</span> <span class="org-string">"$p is not a directory in a Unison hierarchy on this machine"</span>
    <span class="org-keyword">fi</span>
}


<span class="org-comment-delimiter"># </span><span class="org-comment">look for definitions</span>
<span class="org-function-name">jargon</span> ()
{
    <span class="org-variable-name">BROWSER</span>=<span class="org-string">"links"</span>
    <span class="org-variable-name">JARGON_URL</span>=<span class="org-string">"http://info.astrian.net/jargon/terms"</span>
    <span class="org-keyword">for</span> i<span class="org-keyword"> in</span> ${<span class="org-variable-name">*</span>}; <span class="org-keyword">do</span>
        ${<span class="org-variable-name">BROWSER</span>} ${<span class="org-variable-name">JARGON_URL</span>}/${<span class="org-variable-name">i</span>}.html
    <span class="org-keyword">done</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">acronym finder</span>
<span class="org-function-name">acro</span> ()
{
    <span class="org-keyword">if</span> [ $<span class="org-variable-name">#</span> = 0 ]; <span class="org-keyword">then</span>
        <span class="org-builtin">echo</span> <span class="org-string">"Usage: $0 acronym"</span>
        <span class="org-builtin">echo</span> <span class="org-string">"Purpose: expand an acronym"</span>
    <span class="org-keyword">else</span>
       <span class="org-comment-delimiter">#</span><span class="org-comment">links "http://www.ucc.ie/cgi-bin/acronym?$1"</span>
        links <span class="org-string">"http://www.acronymfinder.com/af-query.asp?String=exact&amp;Acronym=$1"</span>
    <span class="org-keyword">fi</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">current weather forecasts</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">weather</span>=<span class="org-string">"lynx term=vt100 http://weather.ec.gc.ca/forecast/city_e.html?yyz"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">nmap ()</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">{</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">echo "Enter port #"</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">read port</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">echo "Enter IP range"</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">read range</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">sudo nmap -sT -p $port -P0 -v -T 4 -oG dump-$port-${range////_}.txt $range</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">grep -i open dump-$port-${range////_}.txt</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">}</span>

<span class="org-function-name">timesync</span> ()
{
    <span class="org-keyword">if</span> [ $(id -u) = 0 ]; <span class="org-keyword">then</span>
        ntpdate -u swisstime.ethz.ch
    <span class="org-keyword">else</span>
        <span class="org-builtin">echo</span> <span class="org-string">"Must be root"</span>
    <span class="org-keyword">fi</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">Searching for keyword(s) with Google</span>
<span class="org-function-name">google</span> ()
{
    w3m <span class="org-string">"http://www.google.com/search?q="</span>$<span class="org-variable-name">1</span><span class="org-string">""</span>;
}


<span class="org-comment-delimiter"># </span><span class="org-comment">immediately opens the first match</span>
<span class="org-function-name">texman</span> ()
{
    locate $<span class="org-variable-name">*</span> | grep pdf | grep texlive | head -1 | xargs open;
}

<span class="org-function-name">texlist</span> ()
{
    locate $<span class="org-variable-name">*</span> | grep <span class="org-string">"\(pdf\|dvi\)"</span> | grep <span class="org-string">"\ (texlive\|gwTeX\)"</span>;
}

<span class="org-comment-delimiter"># </span><span class="org-comment">http_proxy="http://hellman:8080"</span>
</pre></div>
</div>
<div id="outline-container-orgheadline18" class="outline-3">
<h3 id="orgheadline18"><span class="section-number-3">4.8</span> Postamble</h3>
<div class="outline-text-3 org-src-container" id="text-4-8">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">* Local Variables</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Local Variables:</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">mode: shell-script</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">mode: outline-minor</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">sh-shell: bash</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">End:</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">.bashrc ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline37" class="outline-2">
<h2 id="orgheadline37"><span class="section-number-2">5</span> Zsh specific</h2>
<div class="outline-text-2" id="text-5"></div>
<div id="outline-container-orgheadline20" class="outline-3">
<h3 id="orgheadline20"><span class="section-number-3">5.1</span> Examples</h3>
<div class="outline-text-3" id="text-5-1">
<ul class="org-ul">
<li><a href="http://aperiodic.net/phil/prompt/">Phil!'s ZSH Prompt</a></li>
<li><a href="http://stevelosh.com/blog/2010/02/my-extravagant-zsh-prompt/">My Extravagant Zsh Prompt</a> (with Git Repository Information)</li>
<li><a href="http://grml.org/zsh/zsh-lovers.html">zsh-lovers</a></li>
</ul>
</div>
</div>
<div id="outline-container-orgheadline21" class="outline-3">
<h3 id="orgheadline21"><span class="section-number-3">5.2</span> Preamble</h3>
<div class="outline-text-3 org-src-container" id="text-5-2">
<pre class="src src-shell">
<span class="org-comment-delimiter">## </span><span class="org-comment">.zshrc --- Z Shell configuration file (for interactive shells)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Copyright (C) 2009-2015 Fabrice Niessen</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Keywords: zsh, dotfile, config</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">* Install:</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">For Cygwin users: Create a shortcut for zsh by using the `mkzsh' command.</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">* Code:</span>
</pre></div>
</div>
<div id="outline-container-orgheadline27" class="outline-3">
<h3 id="orgheadline27"><span class="section-number-3">5.3</span> Variables</h3>
<div class="outline-text-3" id="text-5-3"></div>
<div id="outline-container-orgheadline22" class="outline-4">
<h4 id="orgheadline22"><span class="section-number-4">5.3.1</span> Search path</h4>
<div class="outline-text-4" id="text-5-3-1">
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">extend the PATH var</span>
<span class="org-keyword">for</span> MAYBE_PATH<span class="org-keyword"> in</span> <span class="org-string">"$HOME/bin"</span> <span class="org-sh-escaped-newline">\</span>
                  <span class="org-string">"$HOME/expect"</span> <span class="org-sh-escaped-newline">\</span>
                  <span class="org-string">"$HOME/winbin"</span>;
<span class="org-keyword">do</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">`-d' or `-x'?</span>
    <span class="org-keyword">if</span> [ -e $<span class="org-variable-name">MAYBE_PATH</span> ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">PATH</span>=$<span class="org-variable-name">MAYBE_PATH</span>:$<span class="org-variable-name">PATH</span>
    <span class="org-keyword">fi</span>
<span class="org-keyword">done</span>
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Put the CWD (<code>.</code>) in PATH</b><br />
nil</div>
<p>If you add the CWD to your PATH, just do it:</p>
<ul class="org-ul">
<li>for <b>non-root users</b>,</li>
<li>as the <b>last entry</b> (so, the current directory is only checked as a last resort).</li>
</ul>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-variable-name">PATH</span>=$<span class="org-variable-name">PATH</span>:.
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline23" class="outline-4">
<h4 id="orgheadline23"><span class="section-number-4">5.3.2</span> Prompt</h4>
<div class="outline-text-4" id="text-5-3-2">
<p>Zsh expects that every character in <code>PS1</code> will advance the cursor one space. Wrap any non-printing escape sequences in <code>%{...%}</code>, and it should work. So use <code>%{\e[31m%}</code>, etc.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 13 (info "(zsh)Prompt Expansion")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">some colors</span>
<span class="org-builtin">local</span> <span class="org-variable-name">BLACK</span>=$<span class="org-string">'%{\e[1;30m%}'</span>
<span class="org-builtin">local</span> <span class="org-variable-name">RED</span>=$<span class="org-string">'%{\e[1;31m%}'</span>
<span class="org-builtin">local</span> <span class="org-variable-name">green</span>=$<span class="org-string">'%{\e[0;32m%}'</span>
<span class="org-builtin">local</span> <span class="org-variable-name">GREEN</span>=$<span class="org-string">'%{\e[1;32m%}'</span>
<span class="org-builtin">local</span> <span class="org-variable-name">yellow</span>=$<span class="org-string">'%{\e[0;33m%}'</span>
<span class="org-builtin">local</span> <span class="org-variable-name">reset</span>=$<span class="org-string">'%{\e[0m%}'</span>

<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">TODO</span></span><span class="org-comment"> Insert beep when last command has failed</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">custom prompt settings</span>
<span class="org-variable-name">PROMPT</span>=<span class="org-string">"$green%n@%m$BLACK:$yellow%2. %(?.$GREEN.$RED)%?$reset%(!.#.$) "</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">? - exit code of the previous command</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">n - user name</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">m - machine name</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">. - abbreviated pwd</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">! - su?</span>
</pre></div>
<p>The tricky part was getting the syntax for testing the exit code. The syntax is <code>%(x.true-string.false-string)</code>, where <code>x</code> is some arbitrary testing condition, in this case, <code>?</code> for exit codes. After the first dot, if the test passes, show true-string; if it fails, show false-string after the second dot.</p>
<p><a href="https://github.com/olivierverdier/zsh-git-prompt">https://github.com/olivierverdier/zsh-git-prompt</a></p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment"># prompt on the right hand side of the screen</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">RPROMPT="[%t]"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">git info</span>
. ~/Public/Repositories/git-prompt/zshrc.sh
<span class="org-variable-name">RPROMPT</span>=<span class="org-string">'$(git_super_status)'</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline24" class="outline-4">
<h4 id="orgheadline24"><span class="section-number-4">5.3.3</span> Command history</h4>
<div class="outline-text-4 org-src-container" id="text-5-3-3">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">history</span>
<span class="org-variable-name">HISTFILE</span>=$<span class="org-variable-name">HOME</span>/.histfile
<span class="org-variable-name">HISTSIZE</span>=1000
<span class="org-variable-name">SAVEHIST</span>=1000

<span class="org-comment-delimiter"># </span><span class="org-comment">append new history lines instead of overwriting (important for multiple</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">parallel Zsh sessions!)</span>
<span class="org-builtin">setopt</span> appendhistory

<span class="org-comment-delimiter"># </span><span class="org-comment">don't save command more than once when occuring more often</span>
<span class="org-builtin">setopt</span> HIST_IGNORE_DUPS

<span class="org-comment-delimiter"># </span><span class="org-comment">Use the same history file for all sessions</span>
<span class="org-builtin">setopt</span> SHARE_HISTORY
</pre></div>
</div>
<div id="outline-container-orgheadline25" class="outline-4">
<h4 id="orgheadline25"><span class="section-number-4">5.3.4</span> Term</h4>
<div class="outline-text-4" id="text-5-3-4">
<p>Sett the terminal type explicitly:</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-builtin">export</span> <span class="org-variable-name">TERM</span>=xterm-256color
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline26" class="outline-4">
<h4 id="orgheadline26"><span class="section-number-4">5.3.5</span> Display</h4>
</div>
</div>
<div id="outline-container-orgheadline28" class="outline-3">
<h3 id="orgheadline28"><span class="section-number-3">5.4</span> Aliasing</h3>
<div class="outline-text-3 org-src-container" id="text-5-4">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">some global aliases (expand whatever their position)</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">L</span>=<span class="org-string">"| less"</span> <span class="org-comment-delimiter">#######</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">M</span>=<span class="org-string">"| most"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">G</span>=<span class="org-string">'| grep -E'</span> <span class="org-comment-delimiter">######</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">W</span>=<span class="org-string">'| wc -l'</span> <span class="org-comment-delimiter">####</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">H</span>=<span class="org-string">'| head'</span> <span class="org-comment-delimiter">###</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">S</span>=<span class="org-string">'| sort'</span> <span class="org-comment-delimiter">###</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">T</span>=<span class="org-string">'| tail'</span> <span class="org-comment-delimiter">###</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">F</span>=<span class="org-string">' | fmt -'</span> <span class="org-comment-delimiter">##</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">21</span>=<span class="org-string">"2&gt;&amp;1"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">DN1</span>=<span class="org-string">'1&gt; /dev/null'</span> <span class="org-comment-delimiter">#</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">DN2</span>=<span class="org-string">'2&gt; /dev/null'</span> <span class="org-comment-delimiter">#</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">VM</span>=/var/log/messages
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A</span>=<span class="org-string">'| awk'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A1</span>=<span class="org-string">"| awk '{print \$1}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A2</span>=<span class="org-string">"| awk '{print \$2}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A3</span>=<span class="org-string">"| awk '{print \$3}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A4</span>=<span class="org-string">"| awk '{print \$4}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A5</span>=<span class="org-string">"| awk '{print \$5}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A6</span>=<span class="org-string">"| awk '{print \$6}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A7</span>=<span class="org-string">"| awk '{print \$7}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A8</span>=<span class="org-string">"| awk '{print \$8}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">A9</span>=<span class="org-string">"| awk '{print \$9}'"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">CA</span>=<span class="org-string">"| cat -A"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">ND</span>=<span class="org-string">'$(ls -d *(/om[1]))'</span> <span class="org-comment-delimiter"># </span><span class="org-comment">newest directory</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">NF</span>=<span class="org-string">'$(ls *(.om[1]))'</span>    <span class="org-comment-delimiter"># </span><span class="org-comment">newest file</span>

<span class="org-builtin">alias</span> -g <span class="org-variable-name">EG</span>=<span class="org-string">'|&amp; egrep'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">EH</span>=<span class="org-string">'|&amp; head'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">EL</span>=<span class="org-string">'|&amp; less'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">ET</span>=<span class="org-string">'|&amp; tail'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">X</span>=<span class="org-string">'| xargs'</span>

<span class="org-builtin">alias</span> -- <span class="org-variable-name">cdwd</span>=<span class="org-string">'cd `pwd`'</span>
<span class="org-builtin">alias</span> -- <span class="org-variable-name">cwd</span>=<span class="org-string">'echo $cwd'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">h</span>=<span class="org-string">'history 1 | less +G'</span>
<span class="org-builtin">alias</span> -- <span class="org-variable-name">l</span>=<span class="org-string">'ls -lg'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">find</span>=<span class="org-string">'noglob find'</span>
</pre></div>
</div>
<div id="outline-container-orgheadline29" class="outline-3">
<h3 id="orgheadline29"><span class="section-number-3">5.5</span> Ledger</h3>
<div class="outline-text-3 org-src-container" id="text-5-5">
<pre class="src src-shell">
<span class="org-builtin">export</span> <span class="org-variable-name">LEDGER</span>=ledger
<span class="org-builtin">export</span> <span class="org-variable-name">LEDGER_FILE</span>=/home/fni/Personal/Business/Accounting/LEDGER.dat

<span class="org-comment-delimiter"># </span><span class="org-comment">hledger print [REGEXP]... - show entries in Ledger format</span>
    <span class="org-comment-delimiter">#</span><span class="org-comment">! `hledger' is better than `ledger' in the sense that it does output</span>
    <span class="org-comment-delimiter">#</span><span class="org-comment">! 2 decimals whatever the figure, and that it does not output trailing</span>
    <span class="org-comment-delimiter">#</span><span class="org-comment">! spaces. There is no other difference (not even in indentation).</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">other problem with ledger: reports onto 81 columns when using other DATEFMT...</span>

<span class="org-builtin">alias</span> -g <span class="org-variable-name">LG</span>=<span class="org-string">"\$LEDGER -f \$LEDGER_FILE"</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">DATEFMT</span>=<span class="org-string">'-y %Y/%m/%d'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">for output</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">DAILY</span>=<span class="org-string">'--period "daily"'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">DLM</span>=<span class="org-string">'--display "d&gt;=[last month]"'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">display of last month</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">CLM</span>=<span class="org-string">'-p "last month"'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">computed total of last month</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">D1</span>=<span class="org-string">'--display "l&lt;=1" --depth 1'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">D2</span>=<span class="org-string">'--display "l&lt;=2" --depth 2'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">BALANCE_SHEET</span>=<span class="org-string">'^Assets ^Liabilities'</span>
<span class="org-builtin">alias</span> -g <span class="org-variable-name">PROFIT_LOSS</span>=<span class="org-string">'^Expenses ^Income'</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">lastmonth</span>=<span class="org-string">'LG reg TLM'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Ledger -f FILE [OPTIONS] [COMMAND [PATTERNS]]</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Ledger using `ledger', `hledger' or `beancount' (see `$LEDGER')</span>
<span class="org-function-name">Ledger</span> ()
{
    <span class="org-keyword">if</span> [ $<span class="org-variable-name">#</span> -lt 1 ]; <span class="org-keyword">then</span>
        cat &lt;&lt; EOF 1&gt;&amp;2
<span class="org-sh-heredoc">Usage: $(basename $0) -f FILE [OPTIONS] [COMMAND [PATTERNS]]</span>
<span class="org-sh-heredoc">    or $(basename $0) FILE   (if LEDGER=beancount)</span>
<span class="org-sh-heredoc">EOF</span>
    <span class="org-keyword">fi</span>

    <span class="org-keyword">case</span> ${<span class="org-variable-name">LEDGER</span>} <span class="org-keyword">in</span>
        <span class="org-string">"beancount"</span> )
            ;;

        * )   <span class="org-comment-delimiter"># </span><span class="org-comment">default option</span>
            <span class="org-builtin">shift</span>;  <span class="org-comment-delimiter"># </span><span class="org-comment">for the useless (but expected) `-f'</span>
            ;;
    <span class="org-keyword">esac</span>
    <span class="org-builtin">local</span> <span class="org-variable-name">LEDGER_M4_FILE</span>=$<span class="org-variable-name">1</span>; <span class="org-builtin">shift</span>;

    <span class="org-builtin">local</span> <span class="org-variable-name">LEDGER_FILE</span>=sample-ledger.dat;
    <span class="org-keyword">case</span> ${<span class="org-variable-name">LEDGER</span>} <span class="org-keyword">in</span>
        <span class="org-string">"beancount"</span> )
            m4 -D <span class="org-variable-name">LEDGER</span>=beancount ${<span class="org-variable-name">LEDGER_M4_FILE</span>} |<span class="org-sh-escaped-newline">\</span>
            sed -e <span class="org-string">'s/\(.*\)(\(.*\)) \(.*\)/\1\3 | \2/g'</span> &gt; ${<span class="org-variable-name">LEDGER_FILE</span>}
            bean-web ${<span class="org-variable-name">LEDGER_FILE</span>} $<span class="org-variable-name">@</span>   <span class="org-comment-delimiter"># </span><span class="org-comment">beancount Web interface</span>
            ;;

        * )   <span class="org-comment-delimiter"># </span><span class="org-comment">default option</span>
            m4 ${<span class="org-variable-name">LEDGER_M4_FILE</span>} |<span class="org-sh-escaped-newline">\</span>
            sed -e <span class="org-string">'s/^@/;@/'</span> &gt; ${<span class="org-variable-name">LEDGER_FILE</span>}
            ${<span class="org-variable-name">LEDGER</span>} -f ${<span class="org-variable-name">LEDGER_FILE</span>} $<span class="org-variable-name">@</span>
            ;;
    <span class="org-keyword">esac</span>
    rm ${<span class="org-variable-name">LEDGER_FILE</span>}
}

<span class="org-comment-delimiter"># </span><span class="org-comment">cat file.ledger | sed -e 's/@check/;@check/' | xargs bean-web</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Use wrapper scripts around gpg with armor on (The --armor option means ascii</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">versus binary). You'll have to enter a password every time you want to run</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ledger.</span>
</pre></div>
</div>
<div id="outline-container-orgheadline30" class="outline-3">
<h3 id="orgheadline30"><span class="section-number-3">5.6</span> Functions</h3>
<div class="outline-text-3 org-src-container" id="text-5-6">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 9 (info "(zsh)Functions")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">ll ()</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">{</span>
<span class="org-comment-delimiter">#     </span><span class="org-comment">ls -lag $* | more</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">}</span>

<span class="org-function-name">term</span> ()
{
    <span class="org-builtin">setopt</span> noglob;
    <span class="org-builtin">unset</span> TERMCAP;
    <span class="org-builtin">eval</span> <span class="org-sh-quoted-exec">`tset -s -I -Q - $*`</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">hgrep PATTERN - print the history lines matching PATTERN</span>
<span class="org-function-name">hgrep</span> ()
{
    <span class="org-builtin">history</span> 0 | grep $<span class="org-variable-name">1</span>
}
</pre></div>
</div>
<div id="outline-container-orgheadline31" class="outline-3">
<h3 id="orgheadline31"><span class="section-number-3">5.7</span> Source common files</h3>
<div class="outline-text-3 org-src-container" id="text-5-7">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 17 (info "(zsh)Shell Builtin Commands")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">source common aliases</span>
<span class="org-keyword">if</span> [ -r $<span class="org-variable-name">HOME</span>/.commonshrc ]; <span class="org-keyword">then</span>
    . $<span class="org-variable-name">HOME</span>/.commonshrc
<span class="org-keyword">fi</span>
</pre></div>
</div>
<div id="outline-container-orgheadline32" class="outline-3">
<h3 id="orgheadline32"><span class="section-number-3">5.8</span> Line Editor</h3>
<div class="outline-text-3" id="text-5-8">
<p>Useful keybindings:</p>
<dl class="org-dl">
<dt><code>M-q</code></dt>
<dd>Type another command in the middle of a long command (look at man, etc.).</dd>
<dt><code>M-.</code></dt>
<dd>Recall the last argument of the previous command, and so on.</dd>
<dt><code>C-r</code></dt>
<dd>Do an interactive search across all of the history.</dd>
</dl>
<p>Useful commands:</p>
<dl class="org-dl">
<dt><code>vared VAR</code></dt>
<dd>Interactively edit variable VAR.</dd>
</dl>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 18 (info "(zsh)Zsh Line Editor")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">behave like Emacs when editing</span>
<span class="org-builtin">bindkey</span> -e

<span class="org-comment-delimiter"># </span><span class="org-comment">mappings for `Ctrl-up/down' for matching commands from the history</span>
<span class="org-builtin">bindkey</span> <span class="org-string">';5A'</span> history-search-backward
<span class="org-builtin">bindkey</span> <span class="org-string">';5B'</span> history-search-forward

<span class="org-comment-delimiter"># </span><span class="org-comment">mappings for `Ctrl-left/right' for word moving</span>
<span class="org-builtin">bindkey</span> <span class="org-string">';5C'</span> forward-word
<span class="org-builtin">bindkey</span> <span class="org-string">';5D'</span> backward-word

<span class="org-comment-delimiter"># </span><span class="org-comment">beep on errors</span>
<span class="org-builtin">setopt</span> beep

<span class="org-comment-delimiter"># </span><span class="org-comment">making zsh beep like Bash when backspacing on an empty command line</span>
<span class="org-function-name">backward-delete-char-beep</span> ()
{
    <span class="org-keyword">if</span> (( <span class="org-variable-name">CURSOR</span> == 0 )); <span class="org-keyword">then</span>
        zle beep
    <span class="org-keyword">fi</span>
    zle backward-delete-char
}
zle -N backward-delete-char-beep
<span class="org-builtin">bindkey</span> <span class="org-string">"^?"</span> backward-delete-char-beep
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline33" class="outline-3">
<h3 id="orgheadline33"><span class="section-number-3">5.9</span> Completion Widgets</h3>
<div class="outline-text-3 org-src-container" id="text-5-9">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 19 (info "(zsh)Completion Widgets")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">load general completion</span>
<span class="org-builtin">autoload</span> -Uz compinit &amp;&amp; compinit

<span class="org-comment-delimiter"># </span><span class="org-comment">display a list of completions when you give an ambiguous choice (like Bash)</span>
<span class="org-builtin">setopt</span> autolist

<span class="org-comment-delimiter"># </span><span class="org-comment">zsh will attempt to complete wildcards by expanding them in the command line</span>
</pre></div>
</div>
<div id="outline-container-orgheadline34" class="outline-3">
<h3 id="orgheadline34"><span class="section-number-3">5.10</span> Completion System</h3>
<div class="outline-text-3 org-src-container" id="text-5-10">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">** 20 (info "(zsh)Completion System")</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">case-insensitive completion</span>
zstyle <span class="org-string">':completion:*'</span> matcher-list <span class="org-string">'m:{a-zA-Z}={A-Za-z}'</span>

<span class="org-keyword">if</span> [ <span class="org-string">"$TERM"</span> != <span class="org-string">"dumb"</span> ]; <span class="org-keyword">then</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">eval "$(dircolors -b)"</span>
    <span class="org-builtin">alias</span> <span class="org-variable-name">ls</span>=<span class="org-string">'ls --color=always'</span>
<span class="org-keyword">else</span>
    <span class="org-builtin">alias</span> <span class="org-variable-name">ls</span>=<span class="org-string">'ls -CF'</span>
<span class="org-keyword">fi</span>
</pre></div>
</div>
<div id="outline-container-orgheadline35" class="outline-3">
<h3 id="orgheadline35"><span class="section-number-3">5.11</span> Zsh Modules</h3>
<div class="outline-text-3 org-src-container" id="text-5-11">
<pre class="src src-shell">
<span class="org-comment-delimiter">## </span><span class="org-comment">coloring stderr</span>
<span class="org-variable-name">STDERRRED</span>=$<span class="org-string">'\e[1;31m'</span>
zmodload zsh/system
<span class="org-function-name">color_err</span> () {
    <span class="org-comment-delimiter">## </span><span class="org-comment">sysread &amp; syswrite are part of `zsh/system'</span>
    emulate -LR zsh
    <span class="org-keyword">while</span> sysread
    <span class="org-keyword">do</span>
        syswrite -o 2 <span class="org-string">"${STDERRRED}${REPLY}$terminfo[sgr0]"</span>
    <span class="org-keyword">done</span>
}

<span class="org-keyword">exec</span> 2&gt; &gt;( color_err )
</pre></div>
</div>
<div id="outline-container-orgheadline36" class="outline-3">
<h3 id="orgheadline36"><span class="section-number-3">5.12</span> Others</h3>
<div class="outline-text-3" id="text-5-12">
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">change directory given just path</span>
<span class="org-builtin">setopt</span> autocd

<span class="org-comment-delimiter"># </span><span class="org-comment">use additional pattern matching features</span>
<span class="org-builtin">setopt</span> extendedglob

<span class="org-comment-delimiter"># </span><span class="org-comment">unmatched patterns cause an error</span>
<span class="org-builtin">setopt</span> nomatch

<span class="org-comment-delimiter"># </span><span class="org-comment">immediately report changes in background job status</span>
<span class="org-builtin">setopt</span> notify
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">* Local Variables</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Local Variables:</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">mode: outline-minor</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">End:</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">.zshrc ends here</span>
</pre></div>
</div>
</div>
</div>
<div id="outline-container-orgheadline51" class="outline-2">
<h2 id="orgheadline51"><span class="section-number-2">6</span> Common</h2>
<div class="outline-text-2" id="text-6">
<p>Everything in common between Bash and Z shell will come here.</p>
</div>
<div id="outline-container-orgheadline38" class="outline-3">
<h3 id="orgheadline38"><span class="section-number-3">6.1</span> Preamble</h3>
<div class="outline-text-3 org-src-container" id="text-6-1">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">Hey Emacs, this is a -*- sh -*- file</span>
<span class="org-comment-delimiter">## </span><span class="org-comment">.commonshrc --- Common features between (Linux and Cygwin) Bash and Z Shell</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Copyright (C) 2009-2015 Fabrice Niessen</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Keywords: bash, zsh, dotfile, config</span>
</pre></div>
</div>
<div id="outline-container-orgheadline39" class="outline-3">
<h3 id="orgheadline39"><span class="section-number-3">6.2</span> Default editor</h3>
<div class="outline-text-3" id="text-6-2">
<p>Be sure one of these <b>editors</b> is <b>in your search path</b>!</p>
<p>Note - Right now, I have instead hard-coded the path to Emacs in the <a href="file://d:/Users/fni/bin/emacsclient">file://d:/Users/fni/bin/emacsclient</a> script.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">set the user's preferred text editor</span>
<span class="org-keyword">for</span> editor<span class="org-keyword"> in</span> emacsclientw emacsclient emacs vi; <span class="org-keyword">do</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">find a suitable editor</span>
    <span class="org-keyword">if</span> $(<span class="org-builtin">which</span> $<span class="org-variable-name">editor</span> &gt;&amp; /dev/null); <span class="org-keyword">then</span>
        <span class="org-keyword">case</span> $<span class="org-variable-name">editor</span><span class="org-keyword"> in</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">emacsclient*)</span>
            <span class="org-comment-delimiter">#     </span><span class="org-comment"># # doesn't bother waiting for a response</span>
            <span class="org-comment-delimiter">#     </span><span class="org-comment"># export EDITOR="$editor --no-wait"</span>
            <span class="org-comment-delimiter">#     </span><span class="org-comment">export EDITOR="$editor -t"</span>
            <span class="org-comment-delimiter">#     </span><span class="org-comment">;;</span>
            *)
                <span class="org-builtin">export</span> <span class="org-variable-name">EDITOR</span>=<span class="org-string">"$editor"</span>
                ;;
        <span class="org-keyword">esac</span>
        <span class="org-builtin">alias</span> <span class="org-variable-name">e</span>=<span class="org-string">"$EDITOR"</span>
        <span class="org-builtin">alias</span> <span class="org-variable-name">edit</span>=<span class="org-string">"$EDITOR"</span>
        <span class="org-keyword">break</span>
    <span class="org-keyword">fi</span>
<span class="org-keyword">done</span>

<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">FIXME</span></span><span class="org-comment"> 2010-11-04 This causes problems when scp'ing .bash_profile (for</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">example) when this .bashrc is deployed onto the remote SSH server.</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">[ -z "$EDITOR" ] &amp;&amp; echo "No suitable editor found."</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">[ -z "$EDITOR" ] || showvalue EDITOR</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">use `$EDITOR' for programs wanting an editor</span>
<span class="org-builtin">export</span> <span class="org-variable-name">VISUAL</span>=<span class="org-string">"$EDITOR"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">for crontab</span>
<span class="org-builtin">export</span> <span class="org-variable-name">CVSEDITOR</span>=<span class="org-string">"$EDITOR"</span>
<span class="org-builtin">export</span> <span class="org-variable-name">SVN_EDITOR</span>=<span class="org-string">"$EDITOR"</span>
<span class="org-builtin">export</span> <span class="org-variable-name">EDIT</span>=<span class="org-string">"$EDITOR"</span>
<span class="org-builtin">export</span> <span class="org-variable-name">ERROR_EDITOR</span>=<span class="org-string">"$EDITOR"</span>
<span class="org-builtin">export</span> <span class="org-variable-name">FCEDIT</span>=<span class="org-string">"$EDITOR"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">for the fc (fix command) builtin command</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-builtin">alias</span> <span class="org-variable-name">e</span>=<span class="org-string">"emacsclient -a emacs -n"</span>       <span class="org-comment-delimiter"># </span><span class="org-comment">-n is essential part</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline40" class="outline-3">
<h3 id="orgheadline40"><span class="section-number-3">6.3</span> Aliases</h3>
<div class="outline-text-3" id="text-6-3">
<p>Aliases are abbreviations or alternative names (usually mnemonics) for commands. They are commonly used to specify a few options to commands, and then include the rest of the command line.</p>
<p>Aliases should usually be kept simple. If not, they should be converted to:</p>
<ul class="org-ul">
<li>shell functions, or</li>
<li>shell scripts.</li>
</ul>
<p>An alias cannot have an argument like <code>$1</code>.</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">* Aliasing</span>

<span class="org-variable-name">LS_OPTIONS</span>=<span class="org-string">"$LS_OPTIONS --show-control-chars"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">enable color support of ls</span>
<span class="org-keyword">if</span> [ <span class="org-string">"$TERM"</span> != <span class="org-string">"dumb"</span> ]; <span class="org-keyword">then</span>

    <span class="org-comment-delimiter"># </span><span class="org-comment"># add my coloration scheme to directory listings</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">if [ -f $HOME/.dircolors ]; then</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">eval "$(dircolors -b $HOME/.dircolors)"</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">else</span>
    <span class="org-comment-delimiter">#     </span><span class="org-comment">eval "$(dircolors -b)"</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">fi</span>

    <span class="org-builtin">alias</span> <span class="org-variable-name">ls</span>=<span class="org-string">'ls --color=auto'</span>
    <span class="org-builtin">alias</span> <span class="org-variable-name">ll</span>=<span class="org-string">"ls --color=yes --all --group-directories-first -l --human-readable --no-group"</span>
            <span class="org-comment-delimiter"># </span><span class="org-comment">long listing and hidden files</span>
<span class="org-keyword">fi</span>

<span class="org-builtin">alias</span> -- ..=<span class="org-string">'cd ..'</span>
<span class="org-builtin">alias</span> ...=<span class="org-string">'cd ../..'</span>
<span class="org-builtin">alias</span> ....=<span class="org-string">'cd ../../..'</span>
<span class="org-builtin">alias</span> .....=<span class="org-string">'cd ../../../..'</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">g</span>=git
<span class="org-builtin">alias</span> <span class="org-variable-name">s</span>=sudo
<span class="org-builtin">alias</span> <span class="org-variable-name">w</span>=which

<span class="org-comment-delimiter"># </span><span class="org-comment">print PATH with each directory on a new line</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">path</span>=<span class="org-string">'echo $PATH | sed -e "s/:/\n/g"'</span>

<span class="org-builtin">alias</span> <span class="org-variable-name">apts</span>=<span class="org-string">'aptitude search'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">apti</span>=<span class="org-string">'sudo aptitude install --with-recommends'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">aptrm</span>=<span class="org-string">'sudo aptitude remove'</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline41" class="outline-3">
<h3 id="orgheadline41"><span class="section-number-3">6.4</span> Emacs / Org</h3>
<div class="outline-text-3" id="text-6-4">
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-builtin">alias</span> <span class="org-variable-name">em</span>=emacs-minimal
</pre></div>
<p>For branches for which we want to make some development, and keep in track with <code>master</code>:</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-function-name">update_org</span> () {
    (   <span class="org-comment-delimiter"># </span><span class="org-comment">Directory changes made in a subshell do not carry over to the parent shell.</span>
        <span class="org-builtin">cd</span> $<span class="org-variable-name">HOME</span>/Public/Repositories/org-mode;
        git fetch --all --verbose <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; git rebase origin <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; make autoloads <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; <span class="org-builtin">echo</span> DON<span class="org-string">\'</span>T make clean <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; <span class="org-builtin">echo</span> DON<span class="org-string">\'</span>T make <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; <span class="org-builtin">echo</span> DON<span class="org-string">\'</span>T sudo make install <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; <span class="org-builtin">echo</span> DON<span class="org-string">\'</span>T make doc <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; make info <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; sudo make install-info <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; printf <span class="org-string">"Running org_test, please wait (this can take a while)...\n"</span> <span class="org-sh-escaped-newline">\</span>
            &amp;&amp; org_test 2&gt;&amp;1 &gt;/dev/null | tail -n 3
    )
}
</pre></div>
<div class="inlinetask"><b><span class="todo TODO">TODO</span> Don't regenerate autoloads, doc, etc. if nothing new was pulled</b><br />
nil</div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-function-name">org_test</span> () {
    (
        <span class="org-builtin">cd</span> $<span class="org-variable-name">HOME</span>/Public/Repositories/org-mode;
        mkdir /tmp/tmp-orgtest 2&gt; /dev/null <span class="org-comment-delimiter"># </span><span class="org-comment">TMPDIR must exist!</span>
        <span class="org-variable-name">TMPDIR</span>=/tmp/tmp-orgtest emacs -Q --batch -L lisp/ -L testing/ -l org-test.el --eval <span class="org-string">'(setq org-confirm-babel-evaluate nil)'</span> -f org-test-run-batch-tests
    )
}
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-keyword">if</span> [ -d <span class="org-string">"$HOME/Public/Repositories/org-bash-utils"</span> ]
<span class="org-keyword">then</span>
    <span class="org-variable-name">PATH</span>=<span class="org-string">"$HOME/Public/Repositories/org-bash-utils:$PATH"</span>
    <span class="org-builtin">source</span> $<span class="org-variable-name">HOME</span>/Public/Repositories/org-bash-utils/org-alias
    <span class="org-builtin">source</span> $<span class="org-variable-name">HOME</span>/Public/Repositories/org-bash-utils/awk-alias
<span class="org-keyword">fi</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline42" class="outline-3">
<h3 id="orgheadline42"><span class="section-number-3">6.5</span> Grep</h3>
<div class="outline-text-3 org-src-container" id="text-6-5">
<pre class="src src-shell">
<span class="org-builtin">export</span> <span class="org-variable-name">GREP_COLORS</span>=<span class="org-string">"mt=01;33"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">grep through the running processes</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">pgrep</span>=<span class="org-string">'pgrep -fl'</span>
</pre></div>
</div>
<div id="outline-container-orgheadline43" class="outline-3">
<h3 id="orgheadline43"><span class="section-number-3">6.6</span> Pager</h3>
<div class="outline-text-3" id="text-6-6">
<p>Set the user's preferred text pager (<code>cat</code>, <code>more</code> or <code>less</code>) that will be used by programs such as <code>man</code> or <code>git diff</code> to display pages.</p>
<p><code>less</code> is faster than anything else around (with exception of possibly <code>more</code>, but this one feels really archaic).</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-variable-name">PAGER</span>=<span class="org-string">"less"</span>
</pre></div>
<p>Without <code>--raw-control-chars</code>, <code>less</code> outputs the colors as raw escape codes, that is it does not <b>interpret colors</b>. With it, <code>git diff</code> finally shows colors…</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">tailoring `less'</span>
<span class="org-variable-name">LESS</span>=<span class="org-string">"--quit-at-eof --ignore-case --long-prompt --raw-control-chars"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">export LESS="-P ?c&lt;- .?f%f:Standard input.  ?n:?eEND:?p%pj\%.. .?c%ccol . ?mFile %i of %m  .?xNext\ %x.%t   Press h for help"</span>
</pre></div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">Colored man pages: http://linuxtidbits.wordpress.com/2009/03/23/less-colors-for-man-pages/</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Less Colors for Man Pages</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_mb</span>=$<span class="org-string">'\E[01;31m'</span>       <span class="org-comment-delimiter"># </span><span class="org-comment">begin blinking</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_md</span>=$<span class="org-string">'\E[01;38;5;74m'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">begin bold</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_me</span>=$<span class="org-string">'\E[0m'</span>           <span class="org-comment-delimiter"># </span><span class="org-comment">end mode</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_se</span>=$<span class="org-string">'\E[0m'</span>           <span class="org-comment-delimiter"># </span><span class="org-comment">end standout-mode</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_so</span>=$<span class="org-string">'\E[38;5;016m\E[48;5;220m'</span>    <span class="org-comment-delimiter"># </span><span class="org-comment">begin standout-mode - info box</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_ue</span>=$<span class="org-string">'\E[0m'</span>           <span class="org-comment-delimiter"># </span><span class="org-comment">end underline</span>
<span class="org-builtin">export</span> <span class="org-variable-name">LESS_TERMCAP_us</span>=$<span class="org-string">'\E[04;38;5;146m'</span> <span class="org-comment-delimiter"># </span><span class="org-comment">begin underline</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline44" class="outline-3">
<h3 id="orgheadline44"><span class="section-number-3">6.7</span> GraphicsMagick</h3>
<div class="outline-text-3 org-src-container" id="text-6-7">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">GraphicsMagick</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">GIF</span>=<span class="org-string">"gm convert -verbose -interlace LINE"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">thumb</span>=<span class="org-string">"gm convert -geometry 100x100 -interlace LINE -verbose"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">region</span>=<span class="org-string">'sleep 3; gm import selection$(date "+%Y%m%d%H%M%S").jpg'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">screenshot</span>=<span class="org-string">'sleep 5; gm import -window root screen$(date "+%Y%m%d%H%M%S").jpg'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">window</span>=<span class="org-string">'sleep 3; gm import -frame window$(date "+%Y%m%d%H%M%S").jpg'</span>

<span class="org-function-name">gmresize</span> ()
{
    <span class="org-variable-name">FILES</span>=<span class="org-string">"$@"</span>
    <span class="org-variable-name">SCALE</span>=<span class="org-string">"1024x768"</span>
  <span class="org-comment-delimiter"># </span><span class="org-comment">for i in *.(gif|jpeg|jpg|png);</span>
    <span class="org-keyword">for</span> i<span class="org-keyword"> in</span> $<span class="org-variable-name">FILES</span>
    <span class="org-keyword">do</span>
        <span class="org-builtin">echo</span> <span class="org-string">"Processing image $i ..."</span>
        gm convert -scale $<span class="org-variable-name">SCALE</span> <span class="org-string">"$i"</span> $(basename <span class="org-string">"$i"</span> .${<span class="org-variable-name">i</span>##*.})-$<span class="org-variable-name">SCALE</span>.${<span class="org-variable-name">i</span>##*.}
        <span class="org-comment-delimiter"># </span><span class="org-comment">obscure but useful string operations</span>
        <span class="org-comment-delimiter"># </span><span class="org-comment">(see http://www.arachnoid.com/linux/shell_programming.html)</span>
    <span class="org-keyword">done</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">find . -name "*png" | xargs -l -i basename -s ".png" "{}" | xargs -l -i  gm convert -quality 85% "{}.png" "{}.jpg"</span>
</pre></div>
</div>
<div id="outline-container-orgheadline45" class="outline-3">
<h3 id="orgheadline45"><span class="section-number-3">6.8</span> MCit tools</h3>
<div class="outline-text-3 org-src-container" id="text-6-8">
<pre class="src src-shell">
<span class="org-builtin">alias</span> <span class="org-variable-name">sp</span>=sendpatch
</pre></div>
</div>
<div id="outline-container-orgheadline46" class="outline-3">
<h3 id="orgheadline46"><span class="section-number-3">6.9</span> Next</h3>
<div class="outline-text-3 org-src-container" id="text-6-9">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment"># dirty (?) hack</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">alias killspell='kill `pidof hunspell`'</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># use `pkill' (which is pgrep + kill in a single command)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">use `htop' instead of `top'</span>
<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> sudo aptitude install htop</span>
<span class="org-keyword">if</span> $(<span class="org-builtin">which</span> htop &gt;&amp; /dev/null); <span class="org-keyword">then</span>
    <span class="org-builtin">alias</span> <span class="org-variable-name">top</span>=htop
<span class="org-keyword">fi</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">show only my processes</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">mytop</span>=<span class="org-string">'top -u $USERNAME'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">mytop</span>=<span class="org-string">'htop -u $USERNAME'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">grep through the aliases</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">agrep</span>=<span class="org-string">'alias | grep -i'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">directory history</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">dh</span>=<span class="org-string">'dirs -v'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">play safe!</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">rm</span>=<span class="org-string">'rm -i'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">mv</span>=<span class="org-string">'mv -i'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">cp</span>=<span class="org-string">'cp -i'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">display the matched pattern in color</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">grep</span>=<span class="org-string">'grep --color'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">list all files modified in the last 24 hours (last full day)</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">oneday</span>=<span class="org-string">'find . -mtime -1 -print'</span>

<span class="org-comment-delimiter"># </span><span class="org-leuven-highlight"><span class="org-comment">XXX</span></span><span class="org-comment"> my traceroute</span>
<span class="org-keyword">if</span> $(<span class="org-builtin">which</span> mtr &gt;&amp; /dev/null); <span class="org-keyword">then</span>
    <span class="org-builtin">alias</span> <span class="org-variable-name">ping</span>=mtr
<span class="org-keyword">fi</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">hping[2] (run as root!)</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">myping</span>=<span class="org-string">"hping2 -c 100 -2 -p 7 $1"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">myping2</span>=<span class="org-string">"hping2 -d 500 -c 100 -2 -p 7 $1"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">030925 compare /proc with ps (against rootkits)</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">myps</span>=<span class="org-string">"sudo ls -d /proc/* | grep '[0-9]' | wc -l ; sudo ps ax | wc -l"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">get gpg-key from keyserver</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">getkey</span>=<span class="org-string">'gpg --keyserver keys.gnupg.net --recv-keys'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment"># 040210 grep</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">alias g='find . -type f -print0 | xargs -0 grep'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">search through files, ignoring .svn directories</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">svn_find</span>=<span class="org-string">"find . -not \( -name .svn -prune \)"</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">function for grep'ing a string in every SVN revision of a file</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Usage: svn_grep_all_rev PATTERN FILE</span>
<span class="org-function-name">svn_grep_all_rev</span>() {
    svn log $<span class="org-variable-name">2</span> | perl -n -e <span class="org-string">'print "$1\n" if m/^r(\d*)\s+/'</span> | (
        <span class="org-keyword">while </span><span class="org-builtin">read</span> revision; <span class="org-keyword">do</span>
            printf <span class="org-string">"\e[0;33m%s\e[0m\n"</span> <span class="org-string">"Revision $revision:"</span>
            svn cat -r $<span class="org-variable-name">revision</span> $<span class="org-variable-name">2</span> | grep $<span class="org-variable-name">1</span>
            printf <span class="org-string">"\n"</span>
        <span class="org-keyword">done</span>
    )
}

<span class="org-comment-delimiter"># </span><span class="org-comment">040319 send files via netcat</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">on sending side:</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">send() {j=$*; tar cpz ${j/%${!#}/}|nc -w 1 ${!#} 51330;}</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">send dir* $HOST</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Info:</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">${!#} gibt den letzten Parameter (den Hostnamen) zurück,</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">${j/%${!#}/} die übrigen (Liste der Dateien oder Verzeichnisse).</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">receive</span>=<span class="org-string">'nc -vlp 51330 | tar xzvp'</span>


<span class="org-comment-delimiter"># </span><span class="org-comment">If I want to find out which lines in a file are duplicated and want to print</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">them, the following awk script helps:</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">awk 'seen[$0]++ == 1' &lt;filename&gt;</span>


<span class="org-comment-delimiter"># </span><span class="org-comment">honor embedded linefeeds when displaying packets</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">ngrep</span>=<span class="org-string">'ngrep -W byline'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">echo my current external IP address</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">whatismyip</span>=<span class="org-string">'curl -s http://whatismyip.org'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">shortcut to making executable</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">exe</span>=<span class="org-string">'chmod +x'</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">chown current dir and subdirs</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">own</span>=<span class="org-string">'sudo chown -R $USER'</span>


<span class="org-comment-delimiter"># </span><span class="org-comment">Web radio stations</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">europe1</span>=<span class="org-string">'mplayer http://vipicecast.yacast.net/europe1'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">europe2</span>=<span class="org-string">'mplayer mms://vipmms9.yacast.fr/encodereurope2'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">nrj</span>=<span class="org-string">'mplayer mms://vipnrj.yacast.fr/encodernrj'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">rtl</span>=<span class="org-string">'mplayer http://streaming.radio.rtl.fr/rtl-1-44-96'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">rtl2</span>=<span class="org-string">'mplayer http://streaming.radio.rtl.fr/rtl2-1-44-96'</span>


<span class="org-builtin">alias</span> <span class="org-variable-name">off</span>=<span class="org-string">'sudo shutdown -h now'</span>


<span class="org-keyword">case</span> $(uname -s) <span class="org-keyword">in</span>
    Linux*)
        <span class="org-builtin">alias</span> <span class="org-variable-name">vpnup</span>=<span class="org-string">'sudo test; exec sudo openvpn --config $HOME/.hide/OpenVPN-config/mcbe.ovpn --writepid /tmp/openvpn.pid &amp;'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">--daemon'</span>
        <span class="org-builtin">alias</span> <span class="org-variable-name">vpndown</span>=<span class="org-string">'sudo kill -INT `cat /tmp/openvpn.pid`'</span>
        ;;

    CYGWIN*)
        <span class="org-builtin">alias</span> <span class="org-variable-name">vpnup</span>=<span class="org-string">'cd $HOME/.hide/OpenVPN-config; openvpn --config mcbe.ovpn --writepid c:/cygwin/tmp/openvpn.pid &amp;'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">--daemon'</span>
        <span class="org-builtin">alias</span> <span class="org-variable-name">vpndown</span>=<span class="org-string">'killall openvpn'</span>
        ;;
<span class="org-keyword">esac</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">make `du' human readable</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">du</span>=<span class="org-string">'du -h'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">du1</span>=<span class="org-string">'du -h --max-depth=1'</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">dus</span>=<span class="org-string">'du -ms * | sort -rn'</span>  <span class="org-comment-delimiter"># </span><span class="org-comment">ordered by size</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">make `df' human readable</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">df</span>=<span class="org-string">'df -h'</span>


<span class="org-comment-delimiter"># </span><span class="org-comment">`unp' is for archive extract</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">dir</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">back</span>=<span class="org-string">"cd -"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">home</span>=<span class="org-string">"cd $HOME"</span>


<span class="org-builtin">export</span> <span class="org-variable-name">GS_OPTIONS</span>=<span class="org-string">"-sPAPERSIZE=a4"</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">pdfmerge</span>=<span class="org-string">"gs -dBATCH -dNOPAUSE -q -sDEVICE=pdfwrite -sOutputFile=./finished.pdf"</span> <span class="org-comment-delimiter"># </span><span class="org-comment">pdfjoin</span>
<span class="org-builtin">alias</span> <span class="org-variable-name">booklet</span>=<span class="org-string">"psbook | psnup -2 | pstops '2:0,1U(21cm,29.7cm)'"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">for Win32, choose gswin32c</span>
</pre></div>
</div>
<div id="outline-container-orgheadline47" class="outline-3">
<h3 id="orgheadline47"><span class="section-number-3">6.10</span> Functions</h3>
<div class="outline-text-3 org-src-container" id="text-6-10">
<pre class="src src-shell">
<span class="org-comment-delimiter">#</span><span class="org-comment">* Functions</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">list all files modified today only (since start of day only, i.e. 00:00)</span>
<span class="org-function-name">today</span> ()
{
    touch -t <span class="org-sh-quoted-exec">`date +%m%d0000`</span> /tmp/$<span class="org-variable-name">$</span>
    find . -type f -newer /tmp/$<span class="org-variable-name">$</span>
    rm -f /tmp/$<span class="org-variable-name">$</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">ff PATTERN - find file named PATTERN</span>
<span class="org-function-name">ff</span> ()
{
    find . -name $<span class="org-variable-name">1</span> -print
}

<span class="org-comment-delimiter"># </span><span class="org-comment">files PATH - list files in PATH</span>
<span class="org-function-name">files</span> ()
{
    find $<span class="org-variable-name">1</span> -type f -print
}

<span class="org-comment-delimiter"># </span><span class="org-comment">line N FILE - show line N of FILE</span>
<span class="org-function-name">line</span> ()
{
    sed -n <span class="org-string">"$1 p"</span> $<span class="org-variable-name">2</span>
}
</pre></div>
</div>
<div id="outline-container-orgheadline48" class="outline-3">
<h3 id="orgheadline48"><span class="section-number-3">6.11</span> Emacsclient</h3>
<div class="outline-text-3" id="text-6-11">
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">ec FILE - open FILE in a running Emacs</span>
<span class="org-function-name">ec</span> ()
{
    emacsclient --no-wait <span class="org-string">"$1"</span>
}
</pre></div>
<p>I connect to the server with either a terminal or a GUI client like this:</p>
<p>alias et=emacsclient -t # new GUI frame alias ec=emacsclient -c # new terminal frame</p>
</div>
</div>
<div id="outline-container-orgheadline49" class="outline-3">
<h3 id="orgheadline49"><span class="section-number-3">6.12</span> Other</h3>
<div class="outline-text-3 org-src-container" id="text-6-12">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">clean [-r] - remove useless files (recursively)</span>
<span class="org-function-name">clean</span> ()
{
    <span class="org-keyword">if</span> [ <span class="org-string">"$1"</span> = <span class="org-string">"-r"</span> ]; <span class="org-keyword">then</span>
        find . <span class="org-string">\(</span> -name <span class="org-string">"#*"</span> -o -name <span class="org-string">"*~"</span> -o -name <span class="org-string">".*~"</span> -o <span class="org-sh-escaped-newline">\</span>
            -name <span class="org-string">"*.~[0-9]*~"\ </span>-o -name <span class="org-string">".*.~[0-9]*~"</span> -o <span class="org-sh-escaped-newline">\</span>
            -name <span class="org-string">"*.~BASE~"</span> -o -name <span class="org-string">".*.~BASE~"</span> <span class="org-string">\)</span> -ok rm <span class="org-string">"{}"</span> <span class="org-string">";"</span>
    <span class="org-keyword">else</span>
        rm -i <span class="org-string">\#</span>* *~ .*~ *.~[0-9]*~ .*.~[0-9]*~ *.~BASE~ .*.~BASE~
    <span class="org-keyword">fi</span>
}

<span class="org-comment-delimiter"># </span><span class="org-comment">swap FILE1 FILE2 - swap FILE1 and FILE2</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Useful when you want to try a config file obtained from elsewhere, and also</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">keep the old version.</span>
<span class="org-function-name">swap</span> ()
{
    <span class="org-keyword">if</span> [ $<span class="org-variable-name">#</span> != 2 ]; <span class="org-keyword">then</span>
        <span class="org-keyword">return</span> 1
    <span class="org-keyword">fi</span>
    <span class="org-variable-name">tmpfile</span>=/tmp/.swapper.$<span class="org-variable-name">$</span>.$<span class="org-variable-name">RANDOM</span>
    mv -f $<span class="org-variable-name">1</span> $<span class="org-variable-name">tmpfile</span>
    mv -f $<span class="org-variable-name">2</span> $<span class="org-variable-name">1</span>
    mv -f $<span class="org-variable-name">tmpfile</span> $<span class="org-variable-name">2</span>
    <span class="org-keyword">return</span> 0
}


<span class="org-comment-delimiter">#</span><span class="org-comment">** Networking toolbox</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">localnet - find the local network in CIDR notation</span>
<span class="org-function-name">localnet</span> ()
{
    <span class="org-variable-name">IP_ADDRESS</span>=$(ifconfig | grep <span class="org-string">"inet addr:"</span> | head -n 1 | sed <span class="org-string">"s/.*addr:\([0-9.]*\).*/\1/"</span>)
    <span class="org-comment-delimiter"># </span><span class="org-comment">we could use `nm-tool' from `network-manager'</span>

    <span class="org-variable-name">NETMASK</span>=$(ifconfig | grep <span class="org-string">"inet addr:"</span> | head -n 1 | sed <span class="org-string">"s/.*Mask:\([0-9.]*\).*/\1/"</span>)

    <span class="org-comment-delimiter"># </span><span class="org-comment">calculate network value</span>
    <span class="org-builtin">echo</span> $(ipcalc -n -b $<span class="org-variable-name">IP_ADDRESS</span> $<span class="org-variable-name">NETMASK</span> | grep Network | awk <span class="org-string">'{print $2}'</span>)
}


<span class="org-comment-delimiter"># </span><span class="org-comment">whoisonline [TARGET] - list hosts that are online</span>
<span class="org-function-name">whoisonline</span> ()
{
    <span class="org-builtin">local</span> net
    <span class="org-keyword">if</span> [ -n <span class="org-string">"$1"</span> ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">net</span>=<span class="org-string">"$1"</span>
    <span class="org-keyword">else</span>
        <span class="org-variable-name">net</span>=$(localnet)
    <span class="org-keyword">fi</span>
    <span class="org-builtin">echo</span> <span class="org-string">"Discovering online hosts in $net..."</span>
    sudo nmap -sP $<span class="org-variable-name">net</span> | awk <span class="org-string">'/Host / &amp;&amp; / up/ { print $0; }'</span>
}


<span class="org-comment-delimiter"># </span><span class="org-comment">localps [TARGET] - list open ports on hosts that are online</span>
<span class="org-function-name">localps</span> ()
{
    <span class="org-builtin">local</span> hostip
    <span class="org-builtin">local</span> t1
    <span class="org-builtin">local</span> t2
    <span class="org-builtin">local</span> t3

    <span class="org-builtin">local</span> net
    <span class="org-keyword">if</span> [ -n <span class="org-string">"$1"</span> ]; <span class="org-keyword">then</span>
        <span class="org-variable-name">net</span>=<span class="org-string">"$1"</span>
    <span class="org-keyword">else</span>
        <span class="org-variable-name">net</span>=$(localnet)
    <span class="org-keyword">fi</span>

    <span class="org-keyword">for</span> hostip<span class="org-keyword"> in</span> $(nmap -sP $<span class="org-variable-name">net</span> | grep -E <span class="org-string">'Host .* up'</span> | cut -d <span class="org-string">" "</span> -f2-2);
    <span class="org-keyword">do</span>
        <span class="org-variable-name">t1</span>=$(ping -c 4 $<span class="org-variable-name">hostip</span> | grep -e PING | cut -d <span class="org-string">" "</span> -f1-2 | cut -d <span class="org-string">" "</span> -f2-4) ;
        <span class="org-variable-name">t2</span>=$(ping -c 4 $<span class="org-variable-name">hostip</span> | grep -e rtt | cut -d <span class="org-string">"/"</span> -f5-5) ;
        <span class="org-variable-name">t3</span>=$(sudo nmap -sS $<span class="org-variable-name">hostip</span> | grep <span class="org-string">" open "</span>) ;
        <span class="org-builtin">echo</span> -e $<span class="org-variable-name">t1</span> <span class="org-string">" "</span> $<span class="org-variable-name">t2</span> <span class="org-string">"ms\n"</span> $<span class="org-variable-name">t3</span> <span class="org-string">"\n"</span>;
    <span class="org-keyword">done</span>
}


<span class="org-comment-delimiter"># </span><span class="org-comment">watchport HOST PORT - watch TCP port PORT on machine HOST</span>
<span class="org-function-name">watchport</span> ()
{
    <span class="org-keyword">while </span><span class="org-builtin">true</span>; <span class="org-keyword">do</span> clear; nmap $<span class="org-variable-name">1</span> -PN -p $<span class="org-variable-name">2</span>; sleep 5; <span class="org-keyword">done</span>
}


<span class="org-comment-delimiter"># </span><span class="org-comment">rdns [TARGET] - perform reverse DNS lookups</span>
<span class="org-function-name">rdns</span> ()
{
    <span class="org-builtin">local</span> net
    <span class="org-keyword">if</span> [ -n <span class="org-string">"$1"</span> ]; <span class="org-keyword">then</span>
      <span class="org-variable-name">net</span>=<span class="org-string">"$1"</span>
    <span class="org-keyword">else</span>
      <span class="org-variable-name">net</span>=$(localnet)
    <span class="org-keyword">fi</span>
    <span class="org-builtin">echo</span> <span class="org-string">"Performing reverse DNS lookups in $net..."</span>
    nmap -R -sL $<span class="org-variable-name">net</span> |<span class="org-sh-escaped-newline">\</span>
    awk <span class="org-string">'{if ($3 != "not") print "Host " $3 " is " $2}'</span> | grep <span class="org-string">'('</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">You could add "--dns-servers x.x.x.x" after the "-sL" if you need the</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">lookups to be performed on a specific DNS server.</span>
}
</pre></div>
</div>
<div id="outline-container-orgheadline50" class="outline-3">
<h3 id="orgheadline50"><span class="section-number-3">6.13</span> Postamble</h3>
<div class="outline-text-3 org-src-container" id="text-6-13">
<pre class="src src-shell">
<span class="org-comment-delimiter"># </span><span class="org-comment">This is for the sake of Emacs.</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Local Variables:</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">ispell-local-dictionary: "en_US"</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">End:</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">.commonshrc ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline52" class="outline-2">
<h2 id="orgheadline52"><span class="section-number-2">7</span> InputRC</h2>
<div class="outline-text-2" id="text-7">
<p>This file controls the behavior of line input editing for programs that use the Gnu <b>Readline</b> library. Existing programs include FTP, Bash, and Gdb.</p>
<div class="note">
<p>Zsh doesn't use the <code>inputrc</code> file.</p>
</div>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-comment-delimiter">## </span><span class="org-comment">.inputrc --- my Readline Init File</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Copyright (C) 2005-2015 Fabrice Niessen</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">Author: Fabrice Niessen &lt;(concat "fniessen" at-sign "pirilampo.org")&gt;</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Keywords: readline, dotfile, config</span>

<span class="org-comment-delimiter">#    </span><span class="org-comment">_                   _</span>
<span class="org-comment-delimiter">#   </span><span class="org-comment">(_)_ __  _ __  _   _| |_ _ __ ___</span>
<span class="org-comment-delimiter">#   </span><span class="org-comment">| | '_ \| '_ \| | | | __| '__/ __|</span>
<span class="org-comment-delimiter">#  </span><span class="org-comment">_| | | | | |_) | |_| | |_| | | (__</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">(_)_|_| |_| .__/ \__,_|\__|_|  \___|</span>
<span class="org-comment-delimiter">#           </span><span class="org-comment">|_|</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This file is free software; you can redistribute it and/or</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">modify it under the terms of the GNU General Public License as</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">published by the Free Software Foundation; either version 2 of</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">the License, or (at your option) any later version.</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">This file is distributed in the hope that it will be</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">useful, but WITHOUT ANY WARRANTY; without even the implied</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">PURPOSE.  See the GNU General Public License for more details.</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">You should have received a copy of the GNU General Public</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">License along with this file; if not, write to the Free</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">Software Foundation, Inc., 59 Temple Place - Suite 330, Boston,</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">MA 02111-1307, USA.</span>

<span class="org-comment-delimiter">#</span><span class="org-comment">* Code:</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">modify to taste</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">first, include any system-wide settings (ignored if one has his own</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">`.inputrc')</span>
$<span class="org-variable-name">include</span> /etc/skel/.inputrc
$<span class="org-variable-name">include</span> /etc/inputrc

<span class="org-comment-delimiter"># </span><span class="org-comment">allow Meta (Alt) key bindings [line added to the top of my `.inputrc']</span>
<span class="org-builtin">set</span> convert-meta on

<span class="org-comment-delimiter"># </span><span class="org-comment">behave like Emacs when editing</span>
<span class="org-builtin">set</span> editing-mode emacs
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-a/e      Start/End of line</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-f/b      Forward/Backward one character</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-d        Delete one character</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-k        Kill line</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-p/n      Previous/Next command in history</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-r        Search for command in history</span>
    <span class="org-comment-delimiter"># </span><span class="org-comment">Ctrl-i/TAB    File name completion</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">some defaults / modifications for the Emacs mode</span>
$<span class="org-variable-name">if</span> <span class="org-variable-name">mode</span>=emacs

<span class="org-comment-delimiter"># </span><span class="org-comment">mappings for `Ctrl-up/down' for matching commands from the history</span>
<span class="org-string">"\e[1;5A"</span>: history-search-backward
<span class="org-string">"\e[1;5B"</span>: history-search-forward

<span class="org-comment-delimiter"># </span><span class="org-comment">mappings for `Ctrl-left/right' for word moving</span>
<span class="org-string">"\e[1;5C"</span>: forward-word
<span class="org-string">"\e[1;5D"</span>: backward-word

Meta-p: history-search-backward
Meta-n: history-search-forward

$<span class="org-variable-name">endif</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">ignore case while completing</span>
<span class="org-builtin">set</span> completion-ignore-case on

<span class="org-comment-delimiter"># </span><span class="org-comment"># will display all alternatives for completion after one tab keypress</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">set show-all-if-ambiguous on</span>

<span class="org-comment-delimiter"># </span><span class="org-comment">#* get Bash to display accented characters (Emacs *Meta Key* Problems in XTerm)</span>

<span class="org-comment-delimiter"># </span><span class="org-comment"># don't strip characters to 7 bits when reading</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">set input-meta on</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># (synonym of 'meta-flag')</span>

<span class="org-comment-delimiter"># </span><span class="org-comment"># display characters with the eighth bit set directly rather than as</span>
<span class="org-comment-delimiter"># </span><span class="org-comment"># meta-prefixed characters</span>
<span class="org-comment-delimiter"># </span><span class="org-comment">set output-meta on</span>

<span class="org-comment-delimiter">## </span><span class="org-comment">.inputrc ends here</span>
</pre></div>
</div>
</div>
<div id="outline-container-orgheadline53" class="outline-2">
<h2 id="orgheadline53"><span class="section-number-2">8</span> Install environment</h2>
<div class="outline-text-2" id="text-8">
<p>Symlink the files.</p>
<div class="org-src-container">
<pre class="src src-shell">
ln -f -s $(<span class="org-builtin">pwd</span>)/../src/.bashrc        ~/.bashrc
ln -f -s $(<span class="org-builtin">pwd</span>)/../src/.bash_profile  ~/.bash_profile
ln -f -s $(<span class="org-builtin">pwd</span>)/../src/.commonshrc    ~/.commonshrc
ln -f -s $(<span class="org-builtin">pwd</span>)/../src/.inputrc       ~/.inputrc
ln -f -s $(<span class="org-builtin">pwd</span>)/../src/.zshrc         ~/.zshrc
</pre></div>
<p>Or something like…</p>
<div class="org-src-container">
<pre class="src src-shell">
<span class="org-keyword">if</span> [ -d <span class="org-string">"$HOME/src/shellrc/src"</span> ]
<span class="org-keyword">then</span>
    <span class="org-variable-name">PATH</span>=<span class="org-string">"$HOME/src/shellrc/src:$PATH"</span>
<span class="org-keyword">fi</span>
</pre></div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Fabrice Niessen</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
